---
URL: https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj
thumbnail: https://i.ytimg.com/vi/E4PHFnvMzFc/default.jpg
channel: "[[Freya Holm√©r]]"
date: 2024-07-22T16:39:32
published: 2021-02-27T02:03:38
duration: 11891
tags: 
done: false
cover: "[[Pasted image 20240722163940.jpg]]"
---
[[Read it Later|Read it Later]] [time:: "3h 18m 11s"]
# Normal Maps, Tangent Space & IBL ‚Ä¢ Shaders for Game Devs [Part 3]
`````col
````col-md
flexGrow=1
===
![[Pasted image 20240722163940.jpg]]
````
````col-md
flexGrow=1
===
https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj
<iframe width="400" height="210" src="https://www.youtube-nocookie.com/embed/E4PHFnvMzFc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
````
`````
Description:: In this final lecture we dive into normal maps, tangent space, height maps and image-based lighting

If you are enjoying this series, please consider supporting me on Patreon!
üß° https://www.patreon.com/acegikmo

00:00:00 - Intro
00:01:17 - Recap
00:10:34 - Multi-light support (assignment 2)
00:14:48 - .cginc include files
00:21:18 - Multiple passes
00:24:20 - Macros
00:25:15 - Unity's lighting macros
00:47:05 - Questions
00:49:45 - Garden of the sea example 
00:54:39 - Color/Albedo texture
01:00:10 - Normal maps & tangent space
01:27:51 - Questions
01:44:00 - Normal map intensity
01:46:43 - Height/Displacement maps
01:58:18 - Vertex shader texture sampling
02:01:29 - Vertex offset & mesh normal caveats
02:07:29 - Questions
02:24:47 - The importance of ambient light
02:26:18 - Basic ambient light
02:29:35 - Image-based lighting (IBL)
02:33:50 - Skybox shader
02:36:46 - Rectilinear skybox sampling
02:42:00 - Diffuse IBL
02:52:02 - Specular IBL
03:10:23 - Outro

Project Download & Assignments: https://docs.google.com/document/d/1h_7O9n5-q8Kb-rhnMJyF4Tab6i3lH97E4Ykn7tsP-zc

Originally streamed as a course for students at http://futuregames.se/, who were super kind to let me both stream this live as well as upload it here! so massive thanks to the people at FutureGames!!

üíñ Patreon ‚ù± https://www.patreon.com/acegikmo
üê¶ Twitter ‚ù± https://twitter.com/FreyaHolmer
üì∫ Twitch ‚ù± https://www.twitch.tv/acegikmo
üí¨ Discord ‚ù± https://discord.gg/v5VWuga
üå∏ Instagram ‚ù± https://instagram.com/freya_holmer

‚ú´ Video Production by Higher Vision:
‚û• https://twitter.com/HigherVision1
‚û§ Edited by Stelly: https://twitter.com/stelly47050876
# Transcript
[00:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=0) what do you plan to do today uh we're going to go through the previous optional assignment uh we made a Shader for uh like a real-time light and we're gonna update that Shader to support 
[00:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11) multiple lights that's the plan at least for the initial part and then we're going to talk about uh tangent space and normal mapping we might do some more texture based stuff yes and then I have 
[00:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=23) like a bucket of miscellaneous things that might be good to talk about but yeah it's kind of difficult to know how to balance out this time because it's like way too short to cover all of 
[00:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=34) shaders I kind of have to prioritize stuff um so I was thinking I could also ask the students like what they would like to learn if they have some idea of 
[00:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=41) something they really like too no otherwise I'm just going to pick something you're the only one that's my tutorial regarding writing shaders that I've seen that hasn't been like not draw 
[00:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=49) the rest of the aisle um yeah maybe I guess I haven't looked at many other um Shader tutorials but I'm glad that I managed to convey something that I 
[01:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=60) others did not all right I think those students should be dropping in around now I'm just gonna check wait someone redeemed cat ears was that a student who is that not a student it's an important 
[01:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=72) question there we go it's me you're very professional teacher last time we talked about lighting apart from talking about the health part that 
[01:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=83) we made and how like sign distance Fields work um we also did a bunch of lighting math so we started constructing a what's called a brdf a bi-directional 
[01:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=96) reflectance distribution function um which is a function where you have some incoming light from some Source it hits some surface and then it has some sort of distribution 
[01:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=109) um and we did a very simple one where we used a lambertian diffuse component which is a relatively straightforward thing to set up you take the dot product between the normal Direction and the 
[02:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=121) light Direction um and if you do that you get this very diffuse fall off here so what you can see this whole lit area is the diffuse 
[02:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=131) section and then we also looked at specular Reflections which is this dot here and the specular Direction depends on the viewing angle so that's how you get the more shiny looking things and 
[02:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=144) the one we were looking at was first bong um which is the dot product between the reflected light vector and then the other one we were looking at is a 
[02:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=154) blindfong which is a bit of a weird hack but it's closer to reality generally so the blindfong relies on a weird Vector called the half Vector sometimes the half angle vector and which is basically 
[02:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=169) halfway between the light vector and the view vector and then you do the dot product between the half vector and the normal Direction and then you end up with a glossy highlight that looks 
[02:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=179) slightly more close to how real surfaces behave um so it's just it's a bit of a weird hack but empirically it works better but these are kind of pretty old lighting models generally 
[03:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=191) um the more fancy types of shading we have now if you want more realistic shading is that we tend to use something called physically based shading and physically 
[03:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=201) based shading is a huge field physically based shading is not just about brdfs it's also about you know you can have a whole physically based pipeline in your render pipeline as in your cameras don't 
[03:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=218) have a like you don't have a number for field of view and stuff like that you have like actual camera values for like um you know F ratio and ISO values and focal length and stuff like that so 
[03:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=232) usually that's also part of a physically based render pipeline but in this case um we're looking at a very very basic lighting function and we're kind of ignoring a lot of the concepts in 
[04:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=243) physically based shading um such as like energy conservation where if you have a light beam coming in you don't want the reflected energy to be be higher than the incoming energy 
[04:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=254) but in most of these like older shading methods you kind of don't care about that because it's all just like oh we do whatever looks good right and you kind of just discard reality 
[04:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=265) um which in many cases is fine kind of depends on if you want to have a realistic art style or not yeah yeah all right was that good enough for a quick recap 
[04:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=273) um I don't know if we should go into the actual details we probably should so we set that up here in the fragmentator we have our diffuse lighting here set up the normal Vector the light vector and 
[04:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=284) then we get the lambertian shading which is the diffuse shading and that's the dot product between normal Vector light vector and then to get the diffuse light we also need to multiply it by the light 
[04:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=294) color and because light color contains obviously the color information and also the intensity because the intensity in unity kind of just multiplies this color by some value so that when you change 
[05:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=307) intensity here um you will also see that reflected in the um in the changes of the lighting of these objects and then we have the 
[05:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=317) specular lining and we're using blindfong in this case so we're setting up the view Vector the direction from the point we're rendering to the camera and then the half angle vector and that 
[05:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=329) is halfway between uh the light vector and the view vector and then we do the dot product between the half Vector the normal vector and then we get the specular light fall off we also multiply 
[05:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=342) by where the lambertian is greater than zero and because otherwise we tend to get specular Reflections on the wrong side of objects um so in this case we don't want these 
[05:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=354) Reflections to shine here because that's on the back side of where the light source is so sometimes you need to cut it off like that and there are different ways of doing it sometimes you 
[06:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=365) will see people multiplying by the lamb version which will generally reduce the reflection in many places which usually looks pretty weird but you can do it that way if you want I don't know why it 
[06:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=377) didn't show up at all there um anyway so that's just to prevent weird um Educators then we have the specular exponents so even though you have the specular light generally you 
[06:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=389) also want to raise that to the power of something in order to make the glossiness be a bit more sharp because we want to be able we want to be able to tweak the glossiness right 
[06:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=400) um is a you know very shiny or is it not super shiny but it still has a specular reflection um so this is really it's really useful to be able to tweak that so given a 
[06:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=410) gloss value between zero to one we remap that to an exponential curve and then we we have more of a useful realistic value to Value range to work with and it makes it feel more linear otherwise if we 
[07:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=425) don't do this remapping we're going to see a lot of changes between like one and five and then not much happens until we reach values like 1000 or whatever so like 
[07:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=437) um it's not a very linear relationship ships that's useful to be able to tweak that in a more intuitive way and if you're if you're using a lot of texture Maps if you have like a physically based 
[07:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=449) scanned surface or something then quite often instead of having a single gloss value for the entire Shader you would have a gloss map a texture sometimes called glass map sometimes it's a 
[07:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=462) roughness map in which case it's inverted and that would then like tell you how shiny it is on any given position on this surface right oh we actually looked at an example of that 
[07:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=474) earlier not the map itself but and this this one so you can see that the uh the glossiness on the lips very shiny right you have the gloss highlight there uh but you don't have that on the 
[08:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=487) skin right so very likely uh in this game they have a way of masking that which is probably using a texture um so that then the uh the texture has a gloss map that says that the skin should 
[08:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=499) not be very glossy and then the gloss increases as you hit the more smoother Parts like the lips very very common type gloss mats and looks very good as well especially if you have a lot of 
[08:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=508) variants in them all right so that's gloss we also faked energy conservation which is not mathematically correct whatsoever but this is a concept in physically based shading where you want 
[08:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=521) to make sure that like I mentioned before you want to make sure that the outgoing energy the energy that's reflected off of the surface is not greater than the incoming energy 
[08:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=530) and you can sort of fake it like this if you want um just multiplying the strength of the specular highlight by the the glossiness because what happens is that actually 
[09:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=542) let's just kill the diffuse light for now so we're just looking at the specular part multiply with zero there we go because 
[09:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=550) what usually happens is that the glossier it is the more energy you have in a smaller area right but if it's less glossy the same energy coming in is going to spread out and then it's going 
[09:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=563) to look it's just going to be weaker right so that's that's why you generally want to have this type of behavior where if it's very shiny it should be also be stronger and if it's very matched it 
[09:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=575) should also be weaker and if you want to like look into this you can probably find like if you search for a physically based shading and normalization functions or normalization factor then 
[09:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=587) you can find this type of stuff as well but this is just a hack this was just to show the idea of energy conservation okay cool one method of shading does a standard Shader use it is physically 
[09:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=598) based um I don't know which one it's using um Vega remember that they were using the Oregon IR diffuse component and the uh cooked Torrance specularly 
[10:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=612) brdf but that was a long time ago I think that was in unity five so it I imagine that they probably using something else at this point and it also depends on what platform you're going 
[10:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=623) for probably depends on if you're in htrp versus urp and so forth I'm not sure which one they're using but it is physically based I think that's it for the recap any questions about the all 
[10:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=634) the stuff also did you try to do the assignment the optional assignment nobody did Jesus Christ wow as soon as it's optional right but it is a little complicated I totally I totally get it 
[10:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=646) um I took some time yesterday to to do it and um like I sort of know exactly what to search for and it was a little difficult to find even given that so I totally 
[10:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=659) understand if it's not if it's hard to find so I'm not gonna hold that against you at all so the goal of that assignment was to add support for multiple lights sources so the way that 
[11:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=671) at least this is generally not how all like renders work it depends on the render pipeline how everything's set up this is just how unity's system used to work in the or it might actually still 
[11:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=683) work this way in the built-in render pipeline but I'm not entirely sure now that they've switched to PBR they might be different but this is one way of doing multiple light sources so 
[11:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=696) generally you would render your Shader in multiple passes so this would be the base pass that's the first pass in the base pass you draw kind of the that's when you 
[11:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=708) draw things in ways that you would expect it to you would have opaque shaders if you wanted to be opaque it would write to the depth buffer all of that stuff 
[11:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=717) um and you would draw anything that's supposed to be applied only once so maybe have some ambient light that you want to apply to it so so maybe it's you have some ambient light that's just 
[12:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=731) added overall to the thing and the base pass will then also apply the first directional light so the directional light will I don't know what the directional light's gonna light this 
[12:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=742) object like there we go uh all right so that's a base pass you apply like ambient light and the first light source which is always a directional light uh and then you have a second pass called 
[12:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=753) uh in unity they call it the forward add pass forward because it's uh forward rendering so you can just call it the add a pass the ad pass is a run for every light 
[12:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=766) source for every additional light source hitting this object and the forward add pass will render additively on top of what's already being rendered so so maybe you have some 
[13:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=781) red light source or something that's lighting from from this direction and then maybe you have some some specular highlight coming from coming 
[13:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=793) from that light source so the ad pass will render additively so we can actually just take this layer set it to add and then put it there right on top so this is basically how it 
[13:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=805) works it renders it on top of the existing stuff so the base pass does this then the ad pass is run for every additional light source where it basically re-renders the entire object 
[13:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=816) and adds those colors on top um so that's basically how it works and the way this is done depends on a lot of factors so this is going to be different for like different engines different 
[13:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=829) render pipelines so this is just one of the cases so don't presume that this is always the case usually these says I'm pretty sure Unity renders all light sources in the base pass it doesn't have 
[14:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=841) additional passes which is more optimized and better generally um anyway but I think it's a it's a useful case to look at multi-pass shaders 
[14:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=852) because we haven't looked at that yet um so so let's let's do that all right so as you might expect in this case um if we have a multi-pass Shader where 
[14:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=864) we want to add light sources on top of our existing Shader we could take this entire pass and we could copy it and we could paste it underneath and now we have a second pass 
[14:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=877) but we probably don't want to duplicate all of this code in fact in our case pretty much all of the code is going to be exactly the same so in this case um I think it's a good moment to talk 
[14:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=891) about CG include files because you might have seen that we've been including some of unity's include files here right and let's make one of those because now we literally want to be able to reuse 
[15:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=904) almost an entire Shader specifically for the purpose of adding another pass so let's do that with an include file oh they're like sorted into streams I guess we need to make another 
[15:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=916) folder stream three lighting test multi I'm renaming this one um just found where you can download all 
[15:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=940) the built-in shaders yes downloading the built-in shaders is uh generally that's been my go-to whenever I want to do something that was a match Unity uh downloading the built-in shaders is 
[15:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=950) really really useful you can read them through and and yeah it also includes all of their CG include files although in writer you can navigate to like whenever you use a macro like transform 
[16:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=961) text you can navigate to that one with F12 and then you can see how transform Tax Works in this case it's a it's just a macro that's defined here okay let's see 
[16:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=975) um we're gonna close the old lighting I'm going to close unities great lighting test multi there we go I just 
[16:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=990) wanted to separate these um into another shadery all right you also forgot to restore all the light that we just did 
[16:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1002) um so let's get back the diffuse light and there we go okay so so right now this one doesn't support multiple light sources uh so if we add another light 
[16:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1015) source we've got a light Point light uh this one doesn't affect it whatsoever nothing happens with this one right um so this is where we need to add the 
[17:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1026) add pass this is again specifically for the forward renderer Unity has a deferred render as well so deferred works completely differently compared to the 
[17:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1036) forward rendering so what we're now going to want to do is that we're basically one we basically want to use the the same code for both of these passes but we don't want to copy all of 
[17:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1046) this code so we're going to create a CG include file much the same way that um Unity has a bunch of CG includes this is useful when either you're repeating a lot of code that you've already that you 
[17:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1059) want to just reuse um or if you want to make like a library where you have like macros maybe a bunch of functions or math functions or whatever so it's really useful for just 
[17:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1069) including some code CG include files literally paste code into your CDA program so it's not much fancier than that it just like takes the code jumps it in there right 
[18:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1083) um great so let's make a CG include the way that I create a CG include file because I don't think it's actually supported here 
[18:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1093) um as I create an unlit Shader what do we call it um let's call it FG there we go future games 
[18:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1102) um no actually this would be should be FG lighting and then go to Explorer rename it to CG Inc excuse me 
[18:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1124) would you be so kind to you oh okay you know renaming files is one of the most difficult tasks that you can give windows 
[18:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1134) you can delete the metaphile because that one doesn't apply anymore so this works identical and identically to see style includes do we have if defs as well yes we do 
[19:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1143) which is really really useful all right so now we have the CG include file I'm going to open that and delete everything um so NCG include files you can just 
[19:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1157) write functions there if you want to so if you want to add our inverse slurp we can just add that function and everything's going to work as I expected and if we include that we can use the 
[19:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1166) inverse layer of everywhere um but in this case we don't want to make a library we just want to add a code snippet that we can then reuse right so 
[19:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1177) we had our um lighting test multi is the name of the Shader and it has this one pass which is going to be the base pass um CD includes is is only for the Shader 
[19:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1190) code itself what we're going to do we're going to take pretty much everything from here on you can't include the pragmas in the CG includes I think you can do that after 
[20:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1202) some Unity version I forget which one but they added support with that relatively recently pragma is processed before they include stuff is pasted in for whatever reason 
[20:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1212) um so we're just going to take all of this code cut it and paste it into the FG lighting CD include file so then simply clear in this part if we want to do 
[20:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1224) inverse layer we would have to add like 10 versions for float float to two float three if we were making a library to reuse um I believe so yeah unless you wanted 
[20:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1232) to like cast between them all the time for better or worse uh all right so um so now we have the um we have the CG 
[20:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1242) include and if we want to make this Shader just go back to working the same way it did before all we need to do is include um and then this file so FG lighting.cg 
[20:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1253) Inc all right why is that gray that's a little weird is because it's quote unquote unused there we go um so now we have 
[21:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1264) um it's just double check that it's using the correct one um yep so now this one is still working exactly the same way as before but we've moved the 
[21:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1276) Shader code to a separate file right um okay um so the the reason we did this is because we can now copy this and create another pass without having to copy all 
[21:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1288) of the Shader code that we just did right so this is going to be the base pass and this is going to be the add pass um and there are a few things that are 
[21:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1301) going to be different here so like I mentioned before the ad pass is going to be uh rendered additively on top of the existing stuff because it's just light being emitted and that's just additive 
[21:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1314) so we're going to change the blend mode of the add pass so that's going to be blend mode one and one so remember this is um 
[22:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1325) Source or SRC times 1 plus destination times one so this is just Source plus destination right so that's the the one one that we have here okay um 
[22:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1338) so now this one is additive we're using the same code here um but there are a few things we need to do to add support for all the different lights that we have so far I don't know 
[22:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1349) how this is going to behave it might sort of work let's see we have it's rendering the directional light twice it seems like yeah it's all broken um and that's fine because we have a lot 
[22:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1360) of other things that we need to fix um so the um in order for the like the engine needs to sort of know which one is the base pass and which one is the adipass 
[22:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1372) so so generally you need to tag these um and you do that in with past tags so in this case we want the base paths to be tagged as light mode forward base so light mode is just a way you're 
[23:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1386) telling Unity what is this pass used for um and then we did the same thing for the ad pass but in this case it's going to be forward add because this is the add 
[23:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1396) pass and let's see I don't know how this is going to be step by step I'm kind of curious how broken it's going to be so we got that one um this one is sort of affecting 
[23:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1407) things when I move it but it's all broken and that's fine because I still have a bunch of other things to do now Unity will 
[23:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1417) compile it will Branch the way it compiles depending on um what type of light source this is so it's used it has a bunch of like internal defines for you know is this a 
[23:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1428) point light is this a directional light um so in order to tell Unity to do that type of multi-compiling we also need to have another pragma uh called multi-compile forward add 
[24:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1442) um I didn't think this one is going to make sure that it properly compiles all the different types of light sources we're going to do um 
[24:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1450) all right I think that's it for everything outside of the Shader code itself all right this is still pretty much broken and that's expected so now let's go back to the trainer card a very 
[24:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1462) useful tool when making shaders where you want to share some Behavior or you want to um like basically create templates 
[24:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1471) templates are macros um that's relatively easy to set up so for instance unity's transform text is a macro that kind of just automatically adds the 
[24:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1485) St to this one you just pass in the name of the texture you pass in the UVS and then it's going to do the math required in order to apply the scale offset to that texture right not that we're using 
[24:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1497) a texture in this Shader but so we should probably just remove this um but yeah so transform text is a macro so you can see that it looks a little esoteric but basically it defines this 
[25:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1509) syntax to be replaced by this right and in whenever you want to add a supporters like unity's lighting they tend to use a lot of macros and it can get a little messy as soon as you start looking into 
[25:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1524) the more advanced stuff um so I'm sort of just going to give you the answer for how to do this um and it gets a little messy if you want to like dig like really deep into 
[25:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1534) this especially if you want to go into like how Shadows work and so forth so I'm just giving you the short version because I also don't think it's super relevant to know exactly how to do it 
[25:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1543) more so just the concept of how it works right uh let's see the next thing you need to do in order to add support for all these all of these light sources um is that we want to give some 
[25:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1556) interpolators to Unity because Unity has like macros in order to set up all of this light interpolation stuff or the the lighting stuff and it requires quite a bunch of things 
[26:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1568) um because the way it works is that every light source has a matrix attached to it because you know lights out Edition they have an orientation if it's a spotlight or a directional light so 
[26:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1579) there's quite a bit of math involved just to correctly handle light sources and especially as soon as you start going into directional lights so if you if we make a Unity Cube we'll make a 
[26:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1595) Spotlight or sorry not directional light spotlights so spotlights are a little comp a little more complicated right because they they have this angle and they're supposed to like correctly 
[26:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1606) handle stuff like this right and unity has a bunch of built-in macros to do this so we're just going to hijack those macros and then all of this behavior is going to quote unquote automatically 
[26:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1616) happen right but we're going to insert it into our Shader cell uh go back to the shade room and then basically we want to First give Unity 
[27:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1627) some interpolators to work with and that's also done with a macro so that's uh lighting chords is the name of that macro and then we need to give it a number for what interpolator to use and 
[27:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1639) we're using 0 1 and 2 so we're going to give it three and four and again if you're using a writer then you can navigate to this code as well if you want to see what unity's code looks like 
[27:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1649) which is kind of a macro hell of just nested macros so if you want you could just unpack all of these macros and just write all of the code like straight up but we're just going to use unity's 
[27:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1662) macros for this because it gets much easier um all right so so basically what this does is that it's going to replace lighting chords three four uh with 
[27:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1673) unity's um undefined uh text card three and four and then these have some specific name right and this is just so we can use other macros that then we'll use the same name later on 
[28:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1684) so yes it pretty much just pastes a few lines there yeah okay and then we need to move on to the vertex Shader so in unity's lining system uh they also want to transfer something from the vertex 
[28:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1696) Shader to the fragment Shader um and this mackerel has the incredibly um unfortunate name it's literally called um 
[28:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1708) transfer the vertex to fragment that's the name of this function or this macro which is one of the worst names to give a macro given that it doesn't say that this has 
[28:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1720) anything to do with lighting um I'm sure Unity regrets that but here we are um 
[28:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1730) okay so that one is now basically populating these interpolators with like whatever it needs in order to calculate the lighting and again if we look into this macro it has a bunch of 
[29:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1744) macros in and of itself right and it gets it gets complicated if you want to do this manually because there's a lot that goes into it again you go into using like light textures and Cube maps 
[29:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1756) and Shadow maps and all sorts of stuff right so um so we're transferring the the lighting data from the vertical Shader 
[29:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1766) to the fragment Shader now then there are two more things we need um so now we're in the fragrance heater and now we need the light Direction so previously we presumed that this would 
[29:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1777) be a directional light right and this directional light is um like Point lights don't work the same way because World space light position is either a position or a direction 
[29:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1789) depending on if it's a directional light or a point light but Unity has a function that kind of correctly handles this depending on which type of light source it is so all we need to do 
[30:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1801) um is that we use the unity World space light Direction um yeah and all we need to pass into that one is the world position and which we already have up here because we 
[30:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1814) defined that one here so we can just pass the world position into this so I dot um plural position uh now this one does not normalize if 
[30:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1826) this one is using a point light it's not going to be normalized so we're just going to make sure that that's normalized as well for whatever reason it's called 
[30:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1834) Direction and yet yet it's not normalized which makes me angry um but whatever they repeat this mistake in Shader draft which is also really 
[30:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1844) frustrating like they should call it the light Vector instead of the light Direction but whatever I guess nothing is consistent everything is garbage 
[30:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1854) all right we got the light vector and now we're using unity's macro to do this if we want to see how that looks um there are a few like defines that it's checking 
[31:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1863) um so um yeah you can see some of these are checking whether or not some keyword is defined so this means if not defined um then do this 
[31:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1875) um otherwise then it checks a few other things you know if we're using directional light or if we're not using directional light then we want to subtract World position from the like 
[31:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1884) position because then we get the relative vector and then if it's if it is using the directional light then it's just going to return the world space light position 
[31:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1893) and all of these when you have this hash in front of like if and else and this is done in a pre-compile step so these are not being like checked real time this is either you compile out some of these or 
[31:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1908) you compile to multiple shaders where these conditions are different but but yes anyway so this is unity's function in order to get the world space light Direction great and if you want you 
[32:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1920) could use this in the vertex Shader um but then the direction to the light source is going to be interpolated and maybe you don't want that um so in this case we're just doing that in the 
[32:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1929) fragment Shader which is more expensive but whatever it's fine everything's fine um all right so 
[32:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1940) um so now we should have the the direction to the light source and uh I believe everything should work now except attenuation 
[32:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1949) um and we haven't talked about attenuation yet but if we go back to Unity we can now see that we have two light sources right 
[32:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1960) and we got this one and um sorta kinda works except for the attenuation right because uh Point lights have a have a a range right and you can see that this is usually not 
[32:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1975) what we want to happen uh whenever we're doing whatever we're using Point lights um and that's because we're not taking into account attenuation which is just um that it falls off 
[33:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=1988) um as you move away from the light source the intensity of the light should be weaker the further away it is right all right so we need attenuation kind of a cool effect though it's it's sure if 
[33:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2001) you want you can make a game that does that uh but luckily um we have a um we have a macro for that as well so we just need to 
[33:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2012) um get the attenuation so let's do floats um a 10 or whatever we want to call it let's see type attenuation 10 mutations there we go 
[33:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2024) um so attenuation um you do light attenuation and then it has a parameter and this parameter is the interpolators um we pass I into this one because the 
[33:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2037) uh this macro needs to know what we call our interpolators value uh variable right so pass I into it and now this one is going to read from the interpolators that we defined up here because the 
[34:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2050) macro of lighting chords and the macro of light attenuation they use the same names for those two interpolators um yeah so now we have a value for attenuation so then we want to use this 
[34:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2062) follow-up somewhere and generally we would want to use that in the diffuse light because the diffuse light should obviously fade if it's further away so we're going to multiply the 
[34:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2076) lambertian falloff the diffuse fall off by the attenuation and we're going to do the same for the specular light so specular light is over here so we're just going to just multiply 
[34:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2087) everything in a row by attenuation so attenuation all it does is that it's going to reduce the strength if things go further away the light attenuation macro I'm pretty 
[34:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2099) sure it makes sure that um if it is a directional light it's just going to be one so there's no attenuation because then in that case we just multiply by one which means that 
[35:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2110) it's going to be unchanged right all right there we go so now you can see that the light Fades out as you move it further away so now we don't have that harsh 
[35:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2120) um fall off again okay now there's one more thing that we should do uh where's the camera 
[35:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2131) there is a really really useful tool in unity uh called the frame debugger um I still don't really understand if and deaf is it like defining something if a 
[35:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2142) condition is true I could talk about that after this um so there's something in unity called a frame debugger so in this case we're in the game View 
[35:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2151) and then if you go to window analysis frame debugger uh the frame debugger is a really useful way to look into what is actually happening in your render so you can sort of Step through exactly 
[36:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2166) every step along the way for what is happening during the rendering so okay so we can sort of Step through here it says clear color plus Z Plus stencil so this means that it's clearing the the 
[36:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2178) frame buffer the Z buffer and the stencil buffer basically resets everything and then we go into the drawing might be hard to read which is why I'm reading it out loud the drawing 
[36:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2188) section now renders the opaque geometry there are lots of stuff Happening Here run is a shadow map so that's kind of unity's internals um 
[36:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2198) uh more Shadow stuff um and then here we go so this is the first render of our Shader so this render pass just draws the base right and then if we 
[36:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2211) step to the next one we can see that it adds the uh the second light source on top of that right um and you can see a bunch of data here about how your 
[37:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2222) um what Shader it's using uh what the inputs are so in this case we have you know our own defined parameters uh the view projection Matrix is listed here and so forth so this is really 
[37:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2236) really useful to like see what is happening in your scene if you have some weird rendering happening uh just like going through this whole thing it's very useful 
[37:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2246) um so the frame debugger is a super useful tool um use it whenever you're confused about what's happening um so yeah built into Unity you don't need to add any packages or whatever 
[37:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2258) um yeah um you can check the specific channels as well you can change tweak the levels in case you want to see a specific color 
[37:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2268) range and so forth also known as an inverse alert you know okay so we never talked about those defined the the if def steps so so let's do that all right so 
[38:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2282) let's start by uh let's add something basic let's say that we want to be able to set whether or not some sort of feature is enabled or disabled that's usually when you use the 
[38:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2297) um these uh what are they called defines I don't want to call them Define something but maybe they're just called defines so let's say we want to Define some keyword we just do Define 
[38:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2308) and then let's say we want to let's say we want to do some sort of Define for if we want to have um let's do a simple thing Define red there we go uh we just want to make 
[38:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2319) something red um if this is defined right um all right so we have now defined a keyword just read nothing happens so far we've just 
[38:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2331) defined it so what we can then do is that we can change how this code compiles depending on what that is set to so actually let's do a practical thing 
[39:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2343) use lighting there we go so now this one we're going to have a flag for whether or not we want to use light in this Shader and for to make this a little bit more 
[39:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2355) reasonable I'm just going to go for one light source for now um okay so we have a we Define used lighting 
[39:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2365) and then we want this whole Shader to use light whenever we have this defined so what do we need if we aren't using Lighting in that case we should just output the color of the surface right so 
[39:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2378) then we can do um if death which means if defined so if use lighting is defined then we want to do some code right else we want to do something else and then we end if it's 
[39:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2393) the end of that if statement right um so instead of using brackets you use and if so basically what's going to happen now is that if this keyword is defined the 
[40:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2405) Shader is going to compile this code right here if it's not defined it's going to compile this code all right but in this case it is defined right we defined it at the top here uh 
[40:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2416) but um let's let's just take all of our lighting code and shove it into the use lighting section uh there we go and if we're we are not using uh 
[40:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2428) lighting then in that case uh you are you just want to Output the color right the color of the surface so it's like the if Unity editor things the C sharp yes pretty 
[40:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2440) much all right so in this case um if we have use lighting defined it's going to compile this code if we don't have a Define it's going to compile this code and all right so let's see if it 
[40:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2452) works let's go back currently it is using lighting um let's change the surface of the surface color and then let's see if we undefined this as in we just never 
[41:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2461) Define it and go back and now it's unlit right so that's that's how we can use like um very simple keywords to to Branch this 
[41:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2471) um there are a lot of advanced ways of using this so you can set up what's called a multi-compile where you can for instance add a checkbox to your Shader 
[41:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2484) so that you can toggle whether or not light settings should be on or off and that gets gets a little more complicated I forget the exact syntax it's a little picky but I can look it up if you want 
[41:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2493) to see how to do it but basically you can make you can set up toggles like this um on your material itself and so then you can like pick between two separately 
[41:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2503) compiled shaders that way um do you want to see another example of this because I just thought of another use case that might be useful you have to Define keywords in the Shader file 
[41:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2512) itself so it's mostly useful if you want to have big CD include files so multiple possible branches and when you include that file you can just Define what options you want uh for instance yeah 
[42:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2520) you can use it for a lot of different things um and so yes that's one of the use cases but you can also use it to like um like toggle features on and off 
[42:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2531) um and you can turn them into properties so you can like toggle that property but but you don't need to use um you can set you can Define stuff on materials 
[42:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2543) um with material.set keyword word so you can also just set keywords outside of the Shader itself if you want to oh and if you want to use multiple if you want to check multiple things 
[42:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2556) then instead of typing if def you need to do if defined like this and then you add an or or an and or whatever for some reason that's sort of 
[42:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2569) how the syntax just works out if you want to have multiple things yep yep um 
[42:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2579) all right however this is not going to work the way it's supposed to um when we have multiple light sources um so then this happens so that's why I 
[43:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2591) just had one light source because it would break with another light source but anyway okay I could talk about why if you're curious 
[43:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2598) but basically the problem is that this Shader outputs the color but if we have multiple light sources it's gonna up with the color for every 
[43:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2610) additional light source as well which we probably wouldn't want it to do right but we could solve that too so so for instance um we could do we could Define something 
[43:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2622) like like if is in a base pass for instance then we return color else then we return zero 
[43:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2637) and if there we go uh so is in base pass uh so then in this case um we're now rendering two passes right the base pass and the add pass 
[44:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2652) um but we want to make sure that this one has a specific Define uh in this pass right so in this case we will need to Define this one 
[44:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2664) because we are in the base pass on this one and we want whenever this code executes in the base pass um then we wanted to we want this to be defined also if def there we go yeah 
[44:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2676) otherwise we just want zero um we've done our defined in the main Shader file we could remove the second lighting pass I don't know if you could 
[44:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2685) remove entire passes using defines like that because it defines our only in the Shader code itself not in Shader lab right I'm not sure if we could exclude the 
[44:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2694) entire past using that I'm pretty sure they're scoped yeah I could be wrong but yeah that seems to work if we add this light source now it's not going to break 
[45:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2704) the whole thing um and if we Define used lighting again then everything's going to work that's going to break your brain oh no what a beautiful light source 
[45:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2717) wow oh we should try spotlights they should work but that's right yep okay so one thing that you might have noticed is that uh this is a little bit messy because you're kind of digging 
[45:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2732) into a bunch of macros and unity um and I sort of just gave you the answer out right now uh but just figuring out that this is what you're supposed to do is kind of the hard part 
[45:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2741) of making shaders so there is something in unity called surface shaders so surface shaders are a little bit weird but surface Traders basically give you lighting 
[45:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2754) automatically surface shaders is sort of a Unity specific like pre um like it sort of parses your Shader and automatically adds lighting to it um you can read up on Surface shaders if 
[46:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2766) you want I personally really don't like surface readers because they are very similar to normal shaders but they don't work the same way and the syntax is kind of messed up in some places 
[46:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2779) um so it's just generally very confusing to use them but they give you lighting for free they basically have a function called surf which already gives you the lighting data and the advantage of the 
[46:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2790) surface Shader is that it uses the same lighting as unity's built-in render pipeline um like that one is physically based so you don't need to try to figure out all 
[46:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2800) the macros or whatever um so then in that case you would get consistent lighting yeah but service readers are sort of deprecated in the in Europe and HDR therapy in European hdrp 
[46:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2811) the replacement for surface shaders is Shader graph right because Shader graph also handles all of that for you right Shader refugees does the lighting if you tell it to do the lighting and then 
[47:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2824) that's it right what was the pragma for the main code multi-something um so it's multi-compile forward ad is it hard to learn hlsl if I already know C 
[47:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2836) sharp uh no they're very similar uh if you know C sharp You're Gonna Learn hlsl with no issues at all they're mostly like just a few things that are frustrating like you need to Define 
[47:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2848) functions in the order that you're gonna like like if you want to use a function it has to be defined before you use it which is really frustrating but um yeah it's just stuff like that but 
[47:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2862) yeah macros are like like I think unity's lighting is a pretty good example where macros kind of help you a lot uh specifically because of the fact that they paste code into 
[47:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2872) your Shader code is like that because of that you can make interpolators using macros right which you couldn't do with functions like for instance this lighting cards thing you couldn't do 
[48:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2886) this with a function because um this is literally defining the struct and functions have to run after things have been defined right I feel like the the math course was so much easier to do 
[48:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2900) um like uh so I started I feel like I have to apologize that this is not as linear and clean as the math course uh but it was for some reason it was like way easier to set up the math course and 
[48:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2912) go like going like topic by topic by topic by topic and sort of have them flow into each other naturally uh but going into Shader coding I feel like every time I step into a topic it 
[48:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2925) branches to like five different things that I feel like I have to talk about but going into any of those other things branches into another three topics that I feel like I should also talk about and 
[48:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2936) I need to like make sure that I'm not just like drifting through all of these nodes that I sort of need to have some coherent narrative to the whole thing it's very it's very tricky and it's hard 
[49:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2947) to know how much I should go into like Unity specifics how much I should go into things that depend on the render pipeline versus general concepts just a warning I guess there's a lot that I'm 
[49:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2960) not going to be able to cover um throughout this whole course unfortunately I don't want to about our other teachers but you have nothing to worry about content quality eyes 
[49:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2968) things I feel like it sort of did on the other t-shirts I knew pretty much nothing about shaders or what they could do before this even though we're not going through everything it's a 
[49:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2977) fantastic intro Educators okay good yeah intro to shaders sounds like a better title for this rather than learning everything about shaders so we've been going through uh lighting 
[49:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2987) and how to do multiple light sources well we haven't actually used like textures along with this well technically we have because Unity uses textures internally for some of their 
[49:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=2997) light sources but we are now going to use a diffuse lighting or like use textures that then affect the color of the surface instead of just having a single flat color can you show me the 
[50:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3008) teleport bubble in your intro to Shader coding video teleport bubble I don't oh that one um oh uh I can't show that uh because I 
[50:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3020) made that a kneecorp and they don't really want me to uh show a lot of the internal Shader code because I don't work there anymore um so I unfortunately can't do that but 
[50:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3031) that one is using uh 3D signed distance Fields um and then it's like remarching into that 3D SDF so if you want to look into that you can do that and it's pretty 
[50:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3042) much the same thing as the fractal but instead of a fractal SDF it's just a bunch of blobs that then merge together I'm not going to show you the Shader code but I might still have the project 
[50:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3054) somewhere do we even have this Unity version installed looks like I might have it okay in that case I might be able to show it seems like it sort of works uh okay this is from the game 
[51:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3065) Garden of the sea that we worked on at nikor I don't work there anymore uh but I did work on uh some shaders for it this is a water Shader um 
[51:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3076) for instance I did show an animation of this last time uh where is the pivot point of this mesh there we go it's difficult to see stuff 
[51:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3087) um so for instance this is a very simple water Shader and very stylized and you kind of want to get this like nice little depth fade going on there's some refraction as you can see as well and 
[51:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3098) like distorts the other stuff underneath there's some fake foam along the edges which works good in some cases doesn't work as well in some other cases um but yeah so that's one of the water 
[51:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3111) shaders and then you can press F where you zoom out into Infinity because selecting objects is one of the most difficult Parts when making games in unity 
[52:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3122) um there we go a little pond water this one is supposed to be a little bit more calm so this one is not as exciting as the the big water out there 
[52:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3133) um but yeah anyway I wasn't going to show the water Shader I was going to show the player so this might be a little difficult to see I don't remember all the controls uh 
[52:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3143) jeez um all right I might be able to pause the game or 
[52:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3152) otherwise drop Focus around the game this is difficult oh no how do I do this let's just drag out the prefab into the 
[52:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3162) scene yes uh I believe it was Amanda on our team who did the like out of the art interaction stuff um which was really neat 
[52:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3173) um see if we can find the hand found the hands hell yeah okay here we go this is what I was looking for so this is a goopy little blob 
[53:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3189) so this one is done using um sign distance Fields so 3D sign distance Fields where it's kind of like a ray marching into a field and that is checking the distance to these objects 
[53:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3202) or objects they're not really objects they're just like math um and yeah so so based on uh different parameters it changes how these blobs behave so this is used when teleporting 
[53:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3215) um so depending on the teleport State the bubbles behave in different ways uh so that's the blob you can change a bunch of like parameters for how reflective it should be 
[53:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3225) um for how goopy it should be so this is like no goopiness um in which case it's just a bunch of spheres but you can sort of do a Min function that kind of Blends them 
[53:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3236) together like that anyway yeah so um basically this sphere the mesh is a sphere that's why there's like an outline here and inside of this one in the fragment Shader I just do that type 
[54:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3250) of remarching into into the sign distance field and that's about it that's the that's the thing why is the mesh a sphere not a quad um because I just was lazy because if I 
[54:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3262) make a quad I need to make sure it's facing the camera at all times and I just figured whatever I'll just make a sphere it works doing things in production is different okay 
[54:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3271) you have time constraints so you just slap things together anyway we were not going to talk about this so let's talk about Textures in conjunction with this uh lighting that we just added so 
[54:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3286) um so right now we just have this surface where we can just set some color and that's about it but we can't really set any textures on this thing so I figured 
[54:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3296) um let's let's use the rock texture that we had that we were using for the other stuff I'm going to create I'm going to add a plain beautiful 
[55:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3313) we're going to apply the same material there we go me this plane is the the tessellated plane it doesn't really matter for now but we 
[55:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3335) are going to use this um the fact that it's tessellated later okay so first let's uh let's add textures star Shader right now we just have a 
[55:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3345) color but we don't have a texture so let's add that and remember now that we have um now that our Shader has multiple passes instead of editing uh the Shader 
[55:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3355) that we're applying to the objects we're going to edit the CG include file that we're that shares the same code in the base pass and the add pass um so we're going to change stuff in the 
[56:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3365) CG include instead all right um so um the surface color that we want in this case 
[56:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3378) um I don't know if we should keep the the stuff that we had here we might as well actually um so we need to define the surface color 
[56:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3385) somehow um and we now want to use a texture for that so if we go back to the core Shader we have a property here um just called texture let's call it 
[56:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3396) um rock Albedo um because we're going to use the rock texture probably not good to hard code the word Rock in there but in this case let's just do that 
[56:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3407) um so Albedo is generally what's referred to as the color of the surface Albedo is just a word that you generally see used for physically based shading um generally it's just the term for 
[57:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3420) whatever color the surface is going to be after white light has been reflected um so yeah it's just kind of the base color of the surface 
[57:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3431) um all right so we've got the rock Albedo so you're going to see the terms Albedo probably a lot if you like download texture packs or whatever all right so we've got the rock Albedo but 
[57:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3440) we're not using this so let's use that um in our uh fragment Shader we then want to sample from this texture um right so let's do float4 rock 
[57:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3452) actually let's just do float three no let's do Flip Flip three uh rock equals and then we want to sample the texture so that's going to be a text 2D and The Rock Albedo texture oh we also 
[57:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3468) need to define the thing there um which case we need to rename this we need to rename this 
[57:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3478) there we go okay so then we want to sample this rock texture it's a rock Albedo and then add the UV coordinates of I dot UV we're just going to sample it with UVS all 
[58:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3490) right and then if we want to keep the color parameter if we want to be able to tint this object and then we want to multiply this by the color 
[58:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3500) so um so then we can define something like a surface color so that's going to be Rock multiplied we might want to do RGB there 
[58:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3512) Rock multiplied by color dot rdb so now we got the surface color and then we're using this we're going to replace wherever we used color before by surface color because we want the texture to be 
[58:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3527) part of this so we're just going to replace the lit part of this where we do diffuse light multiply by surface color and the unlit case where we're in the base pass we want to do just the surface 
[58:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3538) color without any lighting applied to it right all right so let's go back currently the texture is just none and the default is Set uh to White so if we haven't 
[59:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3551) assigned a texture it's just going to be a white default texture um in which case it just looks the same because multiplying by one does nothing right 
[59:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3562) um so but we want to add the rock texture to this so search for rock rock Albedo and there we go now we have our Rock texture and everything is lit just the same way it was before 
[59:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3574) it works exactly the same way we can still change the glossiness we can add the color tint if we want to tint this rock but if we set color to white it's just going to be the the same 
[59:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3587) you know color as the texture itself sphere looks like a weird watermelon yeah especially if you like visualize UV coordinates I usually think things just look like mango polished rocks yes these 
[59:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3599) are very very polished rocks um it looks sort of like marble um they're usually polished on top like that 
[01:00:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3608) that's up the intensity on this quite often when you use textures like this there's a lot of detail that we're kind of missing when we don't actually have what's called a normal map 
[01:00:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3622) and in normal map is a way to encode more information about the normal direction of the surface um based on that texture so 
[01:00:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3636) if you consider the [Music] um how normals work on regular vertices or you know how vertex normals work the 
[01:00:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3647) vertex normals themselves are only defined and specified per vertex so we only have a direction here and a direction here and a direction here and so forth any values between across the 
[01:00:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3659) triangle is going to be interpolated right so if we want to have a if we want to have a mesh that has pretty simple geometry you have one vertex you have another vertex 
[01:01:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3672) then quite often you want this surface to look as if it's more bumpy right but if you're just using the vertex normals then that bumpiness is not going to be taken into account because that 
[01:01:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3684) bumpiness is just going to point upwards at all of these points um so when you have some light source that is shining in some direction um then whenever you read the normals 
[01:01:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3696) from the surface it's just going to be shaded as if everything is flat right um so this is the problem that normal Maps solve so what normal Maps do 
[01:01:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3707) is that you define a texture for the surface itself where in this case of course textures are divided into textiles sometimes called pixels but technically texels 
[01:01:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3719) where every pixel in this texture contains a Direction so each of these pixels have a different normal Direction so then you can start defining normals that are 
[01:02:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3735) um different from the actual vertex normals right so then you can start you know trying to match the actual surface of whatever it is you're rendering right 
[01:02:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3746) um so yeah so that's what a normal map is um things get a little bit complicated with normal Maps because um when you map the texture like this 
[01:02:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3757) the question sort of arises of what space are these vectors in um there are different ways of defining normal Maps they can be in different spaces you can find stuff like you can 
[01:02:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3774) find object space normal maps in which case all the normals are going to be stored in object space but usually what you're going to run into is what's called tangent space 
[01:03:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3783) normal Maps uh and we have talked a little bit about tangent space before but essentially tangent space is a space you can construct if you have a surface uh where 
[01:03:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3796) you need some direction uh like that is along the surface as in Tangent to the surface right um so let's say you have a normal Direction 
[01:03:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3807) it's going to be in the normal but if you then have a normal map applied to this then some of these normals you're going to want to bend them in various directions right so 
[01:03:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3819) maybe you want the normal to point like this like maybe you wanted to point like sort of toward the camera um or like almost flat in that direction and so forth but when you have 
[01:03:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3830) coordinate systems like this um you sort of need to define the other two vectors of this coordinate system um so you know where is the x-axis on 
[01:04:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3842) this and because generally the normal would be the z-axis but you know you also need to Define where is the x-axis um and where is the y-axis right and 
[01:04:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3856) generally tangents are usually generated into the vertex State as well so whenever you have an object and you UV map it because this coordinate system is 
[01:04:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3871) going to depend on how you UV map to your mesh then every vertex is going to have two points of data it's going to have a normal Direction that's the usual vertex normal that we talked about 
[01:04:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3882) before but they're also going to have a tangent Direction these are usually generated by your um by your 3D modeling program if it's 
[01:04:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3893) blender or um if it's Maya whatever it is you're using right um yeah so then generally vertices have 
[01:05:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3904) both tangents and normals defined in them right so is this tendon space something we need to do manually or is it automatic you need to set up the tangent space yourself but the tangents 
[01:05:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3917) themselves in the vertex data that is set up for you generally on export from your 3D modeling program or by Unity on import so it depends on like but generally those are generated so the 
[01:05:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3931) data we have to work with is this every vertex has a normal Direction every vertex usually have it has a tangent Direction so we can then use that to construct this tangent space right 
[01:05:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3944) um and then once we read from some texture such as a normal map the normal Maps um every pixel of the normal app contains a direction and that direction 
[01:05:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3956) is in Tangent space um so that's why it's called tangent space normal map so then it's just a cross product between tangent and normal yes that's how you get the by tangent 
[01:06:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3968) um so you have the the red one is the tangent and then the green one is the bi-tangent all right so then um given this let's let's look at what a 
[01:06:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3981) normal map can look like um and in this case I I got some of the free textures from uh quixels Mega scans which is a huge library of 3D scanned textures 
[01:06:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=3994) um so which is really really cool because then we have real normals they're actual normals from real surfaces instead of just being sort of hacked together there are ways you can 
[01:06:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4004) sort of generate normals from your Albedo but they are almost always really bad they sort of give you a bit of a texture to it but generally they don't accurately reflect the surface at all so 
[01:06:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4017) so usually normal maps are there are many ways of getting normal maps in the case of what I'm going to use now I'm going to use the um a pre pre-made normal map this is 
[01:07:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4029) from scanned data and then in some cases if you're doing something like a style stylized game then sometimes it's artist authored in other words an artist will sculpt and create a 3D mesh that is much 
[01:07:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4045) more higher detail than where you're going to use in-game and then you can bake the normals from the high poly version to the low poly version um 
[01:07:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4055) but anyway so this is what a normal map generally looks like it's very pretty I love the aesthetic of normal Maps but anyway so so this is a normal app and what every Vector contains or whatever 
[01:07:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4070) pixel contains is a vector it's a normalized vector pointing in a specific direction right so it's kind of interesting like because of that fact if we open this in Photoshop 
[01:08:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4084) and there we go zoom in a little bit if we look at the color channels of this then the red Channel kind of looks like it lit it's lit from the right right and 
[01:08:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4098) the green Channel looks like it's lit from above because that's sort of the data it contains right and then the blue channel is going to be the the y-axis of this one so this sort of tells you the 
[01:08:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4109) slope from the perspective of the camera um but basically that's what the normal map contains now there's one caveat there in that um 
[01:08:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4121) obviously you can't have negative values in textures like this because usually you want to save it in the zero to one range um so technically 
[01:08:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4130) um this one is remapped to a zero to one range and when you read from this texture you need to unpack this normal uh to a negative one to one range so in actuality once you unpack this we could 
[01:09:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4143) do a levels on this there we go so usually this is more accurately I mean why can I not there we go so now this is what it sort 
[01:09:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4154) of would look like if it was lit from the from the right and from above because now we've unpacked this we remapped the range so that it's negative one to one and it's kind of what it does 
[01:09:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4163) in the Shader itself um but yeah so that one would contain the negative values but in the texture it's just you know um you just remap it to the zero to one 
[01:09:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4172) range but that's not something you need to care about that much um generally um you know this is just going to be done by the whatever generates this 
[01:09:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4180) normal right um okay so that's what a normal map looks like and it's a vector field every pixel contains a direction and that's that's what's important okay 
[01:09:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4193) so now we're going to add a normal map to this surface all right let's open up our uh so each pixel can only contain one color also another one normal uh yes is 
[01:10:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4211) the actual is that the actual normals how did the tangents for each textile get generated it depends on what you mean by is that the actual normal um so this is still in Tangent space 
[01:10:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4223) right it's not the world space normals um so we need to do a conversion from tangent space to World space before we start shading this so basically the the normal map is in the space of this 
[01:10:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4236) um this tangent space and then we need to convert from that to World space using uh the tangent space Matrix that we're going to set up but in order to construct the tangent space itself we're 
[01:10:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4247) going to use the mesh data that we get from the vertices right so we have a normal Direction a tendon Direction and just like any other data that's going to interpolate Across the triangles 
[01:10:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4258) um so just like we had these that were um where we are interpolating the normals we're also going to have tangents that we're going to interpolate Across the surface frame so let's start 
[01:11:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4269) by setting that up [Music] so we're going to want a normal map here so we're going to call this rock normals and this one we don't want it to default 
[01:11:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4291) to White because a white color in a normal map is not a valid normal so if we wanted to look as if it's just flat then we want to want to set the default value to bump it it's short for bump map 
[01:11:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4306) which is a sort of an outdated term for normal Maps yeah so bump will give you just a flat normal as the default value on this one um 
[01:11:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4317) okay so we need to find a property for our normal map and then in unity we can then assign that normal map so we're going to take Moss no Rock 
[01:12:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4328) normal and just shove it in there okay we have our scale offset parameters here where we can scale and stretch the texture in this case we want the scaling 
[01:12:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4339) to be the same for all of our different textures because I don't want to like decouple that so I'm just going to remove the scale offset from the normals to not confuse people 
[01:12:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4351) um I'm just going to do no scale offsets so now the normals don't have the scale offset there so we're going to use the same scale offset for 
[01:12:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4361) um for everything basically all right let's get into the Shader now we need to set up now we need to set up tangent space uh 
[01:12:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4370) I just need to dig up my notes so I don't make any mistakes I don't usually set up I don't use usually use normal Maps I almost never do um I don't use textures textures are 
[01:13:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4380) overrated so so far in the vertex Shader we set up our normal Direction but like I mentioned before you also need the tangent Direction like I mentioned here 
[01:13:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4391) each vertex has a normal add a tangent so we also need to define the tangent and we need to get that from the mesh data itself and right now we're only getting the normal from the mesh data so 
[01:13:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4403) let's get the tangents too so that one uses uses the semantic tangent and we're just going to name that tangent 
[01:13:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4413) and here's a bit of a weird Quirk tangent is a float4 where XYZ is the tangent Direction but W contains the tangent sine so the the W component is just in case you have 
[01:13:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4431) flipped UVS in which case we also need to flip the tangent space so it's a bit of a weird annoying thing that you sort of need to keep in mind that sometimes you need to flip your and mirror your 
[01:14:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4444) tendon space so that's why we have the W component in the tangent but XYZ is just a direction as you would expect um all right 
[01:14:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4456) um so we got the normal and then we need the tangent to also be passed to the fragment Shader so right now we're passing the UV the 
[01:14:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4468) normal the world position but we should probably also pass the tangent Direction so I'm just going to shove that in here text Core 2 is going to be our tangent this one we can just keep as a float 
[01:14:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4481) three we can make make the flipping happen in the vertex Shader so we don't need to have the W component in the fragment Shader so we can just ignore that and then we need to increment these 
[01:14:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4490) because we don't want to use the same interpolator for all of these all right so we've got the normal the tangent and then we probably want to calculate the uh by tangent in the vertex Shader as 
[01:15:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4501) well because we don't need to do that on a per pixel basis so we're going to do another one Tech score three four five six um so our by tangent is also going to be 
[01:15:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4511) calculated in the vertex Shader so by intelligence okay so now we set up the interpolators but we don't actually calculate them yet so we need to do that the uh the easiest one uh is the tangent 
[01:15:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4524) it's similar to the normal you kind of just grab the um write the tendon data from the mesh data and then you just shove that into the interpolator and then it's going to 
[01:15:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4532) be interpolated for the fragment Shader so in this case we're just going to do Unity objects to World Direction and we're just going to pass in the V 
[01:15:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4545) Dot tangent dot XYZ because the W component is not involved here all right so we got the Titan set up and that's now in World space because remember all of the stuff that we have 
[01:15:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4557) in the mesh data is in local space uh or well UVS are in UV space but the normal Direction and the tangent Direction and the vertex position are all local space all right so we got the normal we got 
[01:16:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4568) the tangent and then we need to calculate the by tangent so this is where we need to do a little bit of math we're going to do the cross product so let's just cross it's a built-in Shader 
[01:16:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4578) function so cross product between the normal which we calculated above right o dot normal um so Oda normal is going to get the result of this 
[01:16:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4590) um because V Dot normal is the the data and the mesh and O DOT normal is what we just set up here right so this is going to be in World space uh so we got o.normal and then uh oh dot 
[01:16:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4603) tangent so the cross product between the normal and the tangent gives us the by tangent uh now we need to also make sure that we mirror this when we need to 
[01:16:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4614) um that's the kind of annoying part about like if you either like if your UVS are flipped somewhere we also need to make sure that the normal map gets interpreted the correct way 
[01:17:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4627) um and this is where the W component comes in so we multiply this by V Dot tangent dot w because that 
[01:17:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4637) contains the sign it's either negative one or one so this is going to correctly flip it in case we have flipped UVS and there's one more thing that we also need to add here 
[01:17:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4649) if you flip the mesh in unity for instance if you scale the mesh with a negative scale value then the mesh is going to flip like this right so we also need to take that into 
[01:17:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4662) account which we can do by multiplying by unity World transform parameters dot w there we go I had to write this down because Jesus Christ I don't how will you 
[01:17:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4676) remember this um all right so this is just this is basically just to make sure that any kind of like flipping or scaling that's wonky will be correctly handled right 
[01:18:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4688) okay so now we've set up um our buy tangents um actually let's let's do let's separate this so that we can see a little bit more clearly what's happening 
[01:18:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4702) so this is to correctly handle uh flipping mirroring so so now we set up all of our directions that we need for tangent space well we haven't set up tangent space 
[01:18:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4716) itself this is just the vectors that we need to to prepare that right uh okay so now we can move on to the fragment Shader so this is where we're going to start this is where we're going 
[01:18:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4727) to read from the normal map let's see I've got the surface color um not sure where we should set that up we probably only care about normals if we have lighting so we could put that 
[01:18:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4739) inside of the lighting function itself right because if there's no lighting the normal Direction doesn't matter so we're going to just put that in the lighting 
[01:19:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4748) so now what we want to do is we want to change this direction because this direction is just based on the vertex normals right now we want to use our normal map for this 
[01:19:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4759) um okay so let's let's first start out by just outputting our normals um so let's do a simple return We sample 
[01:19:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4770) our um oh did we not add that to the we did not bronc normals Studio plural yes okay so we got our rock nominals 
[01:19:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4787) over there um so we sample The Rock normals and it's a float4 output so there we go okay so this is gonna look a little 
[01:20:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4800) weird um because you might have expected this to look like just a normal just like the normal map looks when we look at it right but this is a little weird uh 
[01:20:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4811) because sometimes you want to store the normal map in a way that you can compress it but still retain some of the quality in the normal map so usually what's going to happen when you import a 
[01:20:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4824) normal map is that the texture data itself is going to make it so that you only save the X and the Y components because the Z component can be reconstructed with some math right 
[01:20:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4837) because it's a normalized vector so if you know X and Y Z can just be calculated um so what's usually done when you store normal data is you put I forget exactly 
[01:20:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4850) what the configuration is but I think you put the um the like y channel in um or the X component in the y or the green Channel and then you put the Y 
[01:21:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4863) component in the alpha channel so that's usually how you store it just to make sure that the compression uh doesn't destroy your normal map um and that happens automatically in 
[01:21:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4872) unity if you set the texture type to normal map um so unpacking normals is a little bit complicated but I'm pretty sure Unity has a yes unpacked normal so unit has a 
[01:21:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4884) built-in way to just easily unpack normals and if you look at the way it works um you can see that depending on different settings uh you unpack it in 
[01:21:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4894) different ways and you can see that this one has you know red green or Alpha green so it what let's talk um yeah so it sort of depends on like 
[01:21:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4905) how everything is set up but we're just going to use unity's unpack function because then we don't have to we don't have to care about all of this ourselves um so we passed the packed normal into 
[01:21:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4916) it which means that we need to sample the texture which gives us the pack normal and then pass that into the unpacked normal and this should give us the properly unpacked stuff 
[01:22:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4930) um okay uh now this one is a um it's a three component value uh so we need to do float4 in case we want to visualize this zero and then output this 
[01:22:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4943) recompile and there we go and so now we have the properly unpacked normals and like I mentioned before this is going to be unpacked from negative one to one so it's not going to look the same as the 
[01:22:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4955) normal map here but if we want to do that we could um you know we could multiply this by 0.5 add 0.5 go back to Unity and then we did something incorrectly uh 
[01:22:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4969) I feel like this should work why does this not work it's after unpacking um oh actually it's probably because of multiple light sources 
[01:22:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4979) um because this should only happen once right [Music] there we go um so now we have the actual normal map 
[01:23:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=4990) right um we could I guess we could do the if in base pass thing there we go 
[01:23:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5007) now we can bring back our light sources okay things get confusing when you have multiple passes is the moral of the story so now we're just outputting the uh the normals right 
[01:23:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5020) um so it seems like we have the correct data now we have a normal map uh where it very much looks like the same thing um and yeah so there we go so so this right here 
[01:23:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5033) well we're still debugging I might as well stay in here so this gives us the tangent space normal right float three tangent space normal so it's not World space at all right now it's just in 
[01:24:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5047) Tangent space um all right um actually we might as well just stop 
[01:24:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5057) using this because we're not going to be able to debug much else after that uh actually one more thing no never mind we're just gonna trust that it works all right so we have the tendon space normal 
[01:24:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5069) um and then we want to construct the tangent space itself uh because we just know the direction of the normal indignant in space but we don't know what the Titan 
[01:24:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5078) space is and what all directions are there right so what we want to construct here whenever you're making a Space you usually Define that using a matrix and in the case of just transforming 
[01:24:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5090) directions you don't need more than a float three by three Matrix so it's a three by three Matrix that just contains the directions of um 
[01:25:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5101) the three directions that we have defined right you have the normal Direction the tangent Direction and The bi tangent Direction um so usually tangent is X by tangent is 
[01:25:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5113) y and the normal is z z z what is English um anymore no I'm not um all right so float three by three 
[01:25:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5128) then we set up the Matrix so I'm just going to call it MTX tangent to world because that's the transformation we're going to set up equals and then we Define The Matrix in 
[01:25:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5138) here um all right so um yeah then we just set up all the parameters so we're going to do I dot 
[01:25:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5148) tangent dot X um I dot by tangent dot x i dot uh normal dot X and then we basically duplicate this uh and then we have y and Z there we go so now we have our 
[01:26:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5166) tangent to World Matrix yeah so so pretty much all we need to do now is that we can use this Matrix to transform from tangent space to World space so if we now Define the normal we can do 
[01:26:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5180) float three uh n we're just going to override this one um n equals mole which is the matrix 
[01:26:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5191) multiplication function we multiply the tangent to World matrix by the tangent space normal so this gives us the world space normal great and that that should be it 
[01:26:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5203) so go back there we go and now you can see that we have a much more Rich surface which looks way more complicated and interesting right let's delete some 
[01:26:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5215) light surface where's the directional light let's delete that too there you go uh so now you can see that uh it looks way more interesting right uh it has like actual curvature and this looks all 
[01:27:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5229) shiny and wet because it's all diffuse right now um You can obviously change the glossiness uh just like before everything's going to work exactly the 
[01:27:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5237) same way so there you go we did normal maps and now you can see that it looks way more realistically shaded right there's a shadow that's cast here and if we move the light across you can see 
[01:27:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5247) that it's now lit and Shadow is cast on this side instead um and so forth um yeah um and obviously now because we did this 
[01:27:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5256) in a multi-pass Shader I hope we can this still supports multiple light sources as well I don't know if we multiply the color we did okay um yeah so so there you go that's that's 
[01:27:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5267) the basics of normal Maps um any questions it's still not actually 3D nope this is literally just the lighting there's no additional uh like triangles or anything 
[01:28:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5281) that's being added to this which is why it's a very very powerful tool that with a pretty simple texture you can get a very very like Advanced effect out of it that just adds a lot more detail than 
[01:28:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5293) you would otherwise be able to do um so you know this could be made with just two triangles and yet you add all of this detail using texture data instead uh could you show me how the 
[01:28:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5303) normal was calculated again yes uh the normal or how to set up the tangent space uh could you do that like have a mesh with lots of vertices and make the Shader displace it based on the normal 
[01:28:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5312) map uh kinda yes we're gonna do that right after the break we're gonna do soon and that's called a displacement map or a height map and we're going to do that afterwards you can't do that 
[01:28:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5324) using a normal map because a normal map does not have height data it literally just gives you the direction that it's pointing but it's not actually going to give you the type information you can 
[01:28:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5337) derive it from that sort of but that's like a complicated process that you're not going to be able to do real time but yes you can you can do stuff like offsetting things by height using a 
[01:29:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5347) height map or what's called a displacement map uh does a displacement map add extra detail or how does that work and where would they be useful a display to the map would displace the 
[01:29:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5356) vertices so you basically use a texture to offset specific vertices in a tessellated mesh um so yeah so so that's why you use displacement maps for if it's just a 
[01:29:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5369) quad a displacement map or a height map is not going to do anything because you only have vertices at the edges right but if you have a tessellated mesh you can use height maps to offset those 
[01:29:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5381) vertices it's the difference between normal maps and height maps and normal Maps takes care of light and height just modifies the mesh well normal maps and height Maps fundamentally store 
[01:29:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5390) different data a neural map stores a direction for every single Texel whereas a height map stores a just a single value for how high that point is right sometimes you do both sometimes you have 
[01:30:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5405) normal Maps where XYZ is the normal and the W component or the alpha channel is the height so sometimes you can combine them like that I remember doing gloss map once how relevant is that it depends 
[01:30:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5416) on the surface if you want the glossiness to vary across the surface then you usually use a gloss mat for that and like like I mentioned before in shaders you can just replace anything 
[01:30:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5428) with anything and it's still going to work because everything is a vector everything is a color so in our case if you want to have a gloss map you would sample that here right so you would do 
[01:30:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5439) like floats plus equals text 2D um glass map um and then some UV coordinates and then you would sample the glass map and then 
[01:30:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5450) instead of using a single value or a uniform for gloss you would use your texture right um so that's basically how you would use a gloss map also sometimes called a 
[01:31:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5460) roughness map but same idea is just inverted so it's not much more than having another pass scope in your Shader so just adding another another Shader pass is going to make your Shader a 
[01:31:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5473) multi-pass Shader but specifically for lighting we need to also make sure that we tag it with light mode forward bass light mode forward add and the second pass needs to be additive we need to 
[01:31:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5485) also add the multi-compile forward ad then there are a bunch of things like light macros in the Shader itself so I guess it depends on what you're asking do you feel like you'll still be writing 
[01:31:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5494) a lot of Shader code not the unity Shader graph is becoming more feature complete um so I still don't use the Europe or hdrp because I just stick with the 
[01:31:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5505) default built-in pipeline for now because I can make everything I want to make with it and Shader coding by hand in the new render pipeline is an absolute nightmare 
[01:31:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5514) um so like and and I do still want to code shaders by hand because right now Shader graph is not like it's not at feature parity with uh shading coding shaders by hand 
[01:32:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5525) um and I don't know when that's ever going to happen so I just I just like coding it by hand now better than using Shader graph and I have access to all the features right yeah that's why I 
[01:32:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5537) don't like I don't care too much about shading graph right now because I don't I don't need it what's missing in hdrp it's not that hdrp is missing something it's just that 
[01:32:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5546) Shader graph itself does not have support for everything you can do in Shader code um so Shader graph like for instance you can't make multi-pass shaders in Shader 
[01:32:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5557) graph you just can't do that um so it's like oh okay in shade graph you don't have explicit control over over the vertex Trader versus fragment Shader in shade graph everything is done 
[01:32:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5569) in the fragment Shader except for the stuff that's like vertex offset and stuff like that so the um it gets complicated you can't code them at all you can 
[01:33:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5580) um you can code shaders in hcrp and urp however the render pipelines have exploded in complexity so if you want to match unity's shaders you are in for a ride I 
[01:33:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5596) must say they have several levels deep of a nested include files there's macros everywhere it is extremely hard to navigate and instead of like two passes they now have like eight passes for 
[01:33:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5610) different things like oh you need motion vectors for motion blur you need a depth pass so that you can do this and that post effect anti-aliasing depends on all of these 
[01:33:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5619) extra passes existing so it's a bit of a nightmare to do all of this by hand Shader graph will give you those extra passes automatically but Shader graph does not spit out a readable file at all 
[01:33:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5632) like you're sort of stuck in doing things exactly as Unity wants you to do it you can't like customize things further than that without like digging extremely deep into their ever shifting 
[01:34:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5645) grounds of their new render pipelines which sucks I have had meetings with unity where I've talked to them a lot about this problem so hopefully it's going to change in the future but there 
[01:34:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5656) seems to be a lot of internal friction when it comes to this so yes you can make shaders in hdrp and urp as long as you use Shader graph you can also not use shaded graph in which case 
[01:34:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5667) supporting any of the features that's built into Unity is going to be a nightmare so it is possible it's just prohibitively difficult to code my hand in hdrp in Europe that's my issue so 
[01:34:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5680) like for instance if we some of the shaders we've been doing even just doing an unlit Shader um let's say we want to make a Shader that's red if we do that in urp or hdrp 
[01:34:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5692) it's not going to be sorted correctly it's not going to handle depth quick depth correctly and it's going to be a render like in front of stuff and it's going to look weird and it's going to 
[01:35:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5700) break a few things we won't have anti-aliasing on it because unity's anti-aliasing depends on motion vectors so we need motion vectors A motion Vector pass and in order to have 
[01:35:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5713) um their temporal anti-aliasing um and like it just explodes in complexity and it's kind of a shame that's why I'm a little so I'm a little bitter about this uh when you met with 
[01:35:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5725) unity did you get the impression that fixing this was something high priority for them I don't know how much I can talk about this I don't know how much it's supposed to be confidential or 
[01:35:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5733) whatever but the impression I got is that I talk to mostly engineers and people who are like working like with the Shader code um I got the impression that the people 
[01:35:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5745) working on the render pipelines and doing all of this are aware of the problem uh and they would like to fix it but I got the impression that they're under a lot of pressure where they can't 
[01:35:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5756) fix it for whatever reason because it felt like we were all in agreement sort of and they were like yeah this kind of sucks I'm sorry and then nothing sort of I don't know nothing sort of explicit 
[01:36:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5769) came of that so I don't know it just feels like a lot of people play unit are aware of the issue but fixing it I presume is hard and I imagine there's internal friction there as well that was 
[01:36:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5779) the impression I got did you sign anything no I didn't sign anything but I don't want to be an during Unity like I still like Unity I use Unity every day 
[01:36:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5789) um I'm just sad about some of the render pipelines and the direction it's thinking but I'm not going to throw them under the bus just because I'm legally allowed to Dear students see you wearing 
[01:36:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5798) cat ears of course they were the ones who redeemed it so of course they're watching this through this stream um so they're seeing exactly the same things you are apparently Unity are 
[01:36:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5808) changing their open source policy uh yeah I saw that there was something about that where like uh I think urp and maybe hdrp as well is no longer open source they're removing that from GitHub 
[01:36:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5818) but I don't know the reasons for that I imagine again a lot of the people working on it would like it to be open source and this sounds like a decision that came from The High Reps who were 
[01:37:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5827) like oh you know we have competitors maybe we're going to want them to see this code and take it from us or whatever whatever so I just don't want to make it seem like all of the like 
[01:37:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5837) engineers at Unity are all evil and want to us over that like that's not the case at all like Unity are very much aware of all the issues with this so isn't it annoying how tetrahedra can't 
[01:37:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5850) title 3D space I really wish they could does unreal have similar structure to Unity in terms of writing shaders um I so I think unreal I haven't gotten into writing 
[01:37:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5860) shaders in unreal uh like writing them by hand uh but they've been using a shade like a note based shade writer for a very long time uh so I imagine they they still use that 
[01:37:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5872) um and again there's sort of a trade-off with node-based editor quite often where node-based editors gives you a lot of things for free uh where otherwise you would have to do it manually for 
[01:38:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5883) instance setting up a tangent space just to make normal Maps is kind of annoying like sometimes you just want to try it and then see if it looks good or not and then you're done but in node based 
[01:38:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5894) editor that's usually handled by the editor itself things are kind of generated for you and it's way more intuitive it's Visual and it's especially good for artists so if you 
[01:38:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5904) don't know how to code shaders or if you don't know how to code at all the node-based editors kind of save you so if you're an artist node-based editors are hacking wonderful the problem you 
[01:38:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5914) can run into is as soon as you want to do something more something that is not specifically an object in the world that's going to be shaded by lighting as soon as you want to do something other 
[01:38:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5925) than that things get very complicated um so I believe that unreal sort of like Yoshi's mentioning in chat I believe unreal has the same issue that we are now getting in unity with hdrp where you 
[01:39:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5940) know coding shaders by hand is possible but it's so complex that nobody really does it so you sort of have to use the no based editor Who currently uses hdrp and how do they manage I guess smaller 
[01:39:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5951) Studios don't bother I have no idea who's using hdrp to be honest yeah I have no clue I haven't heard of anyone who's using hdrp but then again I don't talk to a lot of people in general so I 
[01:39:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5962) have a pretty biased sample I think most people in my circles are still using the built-in pipeline as far as I've heard but then again my circles are Tech artists and we like to have control over 
[01:39:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5972) the shading so I used hdrp for a project you can make some amazing things in it um yeah so like hdrp is a like that's a fully physically based render pipeline like I mentioned before the cameras have 
[01:39:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5986) like actual camera properties of like you know ISO and F ratios and like focal length and all of that stuff um instead of like a field of view value or whatever so like hdrp is really cool 
[01:39:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=5998) if you want to make like high def stuff it is not as cool if you want to have more control over being able to do custom shaders and do like very like fancy Shenanigans you can pretty much 
[01:40:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6010) only do the fantasy shenanigans that Unity lets you do so it looks very pretty you can make very pretty looking things in hdrp it's just that as soon as you want to be able to customize stuff 
[01:40:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6019) it gets complicated and now you like everything's a nightmare unless you use the LSU ShadowCraft yeah I don't know It's Tricky it's a trade-off of like how much you want to like fit into unity's 
[01:40:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6032) Paradigm of how to do things versus like being able to customize things further so now we have the unreal look and unity looking games yes although there was a Unity look even before hdrp and Erp 
[01:40:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6044) because there are a lot of people who just never touch shaders which is a shame because I feel like shaders really Empower you to do really really really really cool things 
[01:40:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6052) um and can make your game look exactly like you wanted to so if you have like a weird artistic Vision usually you can achieve that if you have access to potatoes right and being able to write 
[01:41:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6062) your own changes I can totally see why people don't dive into this stuff though oh yeah for sure it's complicated and it sometimes seems a little unnecessary and esoteric because it's so opaque yeah so 
[01:41:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6072) literally code completion and like being able to navigate Shader code this is very recent uh this is like something that writer added just a few months ago before that like all the years I've been 
[01:41:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6085) working with shaders autocomplete was never ever a thing like that was just never something you got in Shader coding you were sort of stuck in having to like you know manually like download Unity 
[01:41:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6097) shaders and like search for keywords if you like see how anything worked um so being able to navigate in shaders is like this is very recent um and even just having documentation 
[01:41:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6108) for shaders is also very recent like this is uh it's been a nightmare for a very long time it's slowly getting better but generally Shader coding sucks but it could also be like people who use 
[01:41:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6119) Unity use c-sharp and c-sharp is like literally one of the best IDE experiences out there um and if you compare that to Shader coding the contrast kind of hurts 
[01:42:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6131) um but yeah I still don't get autocomplete when coding shaders you need a writer you need one of the latest versions of writer and if you create a c-sharp file in unity and open it in 
[01:42:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6143) writer then after that point I think the autocomplete kicks in to your shaders uh it's a little weird I don't know why it sometimes doesn't work for people all right let's jump into height maps and 
[01:42:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6157) displacement Maps now we have we've done normal map where every pixel represents a direction right it's pointing somewhere in Tangent space and then we're transforming this between Titan 
[01:42:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6170) space and World space so hopefully this works for these objects too because otherwise it's just testing it on a flat plane might lead you to believe that your space 
[01:43:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6180) transformation works even though it might not so it's always good to test surfaces that are pointing out of the direction but this seems to work um oh yeah and tiling and offset is also 
[01:43:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6190) going to be done on both Maps right now because this is applied to the UV coordinates of both so it's going to scale both the normals and the Albedo 
[01:43:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6201) oh sorry I should probably do that oh so water is quite often done using normal Maps uh that you where you sample multiple normal maps and then you blend them together and when you do that you 
[01:43:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6214) get like an animated surface where the normals are bending um all over the place just because you're blending two different normal Maps really useful when doing water 
[01:43:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6222) because then then instead of just having a static sampling based on UV coordinates um you can like scroll those textures and it might be World space sampled 
[01:43:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6230) instead and then you get this like Dynamic effect because again all of these things are tweakable we can make this like change over time we can you know all of that stuff 
[01:44:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6241) um so oh just to show an example let's say we want to be able to tweak the intensity of the normal map like we want to change how strongly this affects the normals 
[01:44:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6252) um uh that we can do uh so let's add a let's add a property for that let's call it a normal intensity 
[01:44:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6267) there we go uh and then here we would Define the uniform for that all right so then pretty much all we need to do is that we can flatten the 
[01:44:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6286) tangent space normal and this is easier to do in tension space rather than the world space so what we can do is that we can do tendon space normal equals lerp so now we're interpolating between 
[01:45:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6300) a flat normal so a flat normal would be something that points directly up right and in the tendon space z is the um the direction pointing out from the surface so a value of exactly zero 
[01:45:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6319) 0 0 1 would be a flat normal pointing up right so if we do that 0 0 1 is a flat normal and then we have the actual tangent space normal itself 
[01:45:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6331) and then we blend that based on the normal intensity so if intensity is one we have the normal just like we had before but if we reduce it it's going to start blending toward a flat normal 
[01:45:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6342) technically we also need to normalize it here because if we're using a lerp with a direction in some cases it's going to flatten the or it's going to shorten the normal 
[01:45:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6353) we're just going to darken all of our lighting equations um yeah so now this one is blending between um yeah blending between a flat normal 
[01:46:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6362) and the actual normal that we get from the texture uh so now we have a normal intensity slider where we can change how strongly the normal should affect things um so if it's zero it looks like the way 
[01:46:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6375) it did before where everything is incredibly flat um or we can increase the intensity a little bit so now we have a little bit of a bump to the surface or we can just 
[01:46:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6384) like push it up to maximum if we want a really really strong normals here yeah so again all of this Dynamic you could animate this parameter over time if you want you can animate gloss over time you 
[01:46:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6395) can uh like yeah they're like you can just swap anything everywhere and everything is still going to work so right so the next thing right now we've only talked about the normal Direction 
[01:46:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6406) but this one doesn't actually displace the mesh itself the mesh is still completely flat right um so this could be done with two triangle and we still get this like 
[01:46:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6417) complex Lighting in some cases you have tessellated geometry and you want to offset that in the Shader so the actually get more details that are actually going to like correctly 
[01:47:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6430) Parallax because right now even though it looks like there are things Unity camera for going all the way over there even though it looks like we have 
[01:47:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6441) um something like some points that are higher than others like we have this Ridge here if you move the camera it's not actually going to look as if it has any height it's all flat but it's still 
[01:47:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6453) shaded as if it has Heights right there are many different ways you can either like fake this using Parallax mapping or Parallax occlusion mapping or you can displace the geometry itself if you have 
[01:47:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6464) tessellated geometry and in this case we actually do have tessellated geometry so if we go into wireframe you can see that this one we do have a wireframe it's very very densely 
[01:47:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6475) tessellated so this is not just two triangles so given that we have this detail in the mesh we can actually offset these vertices in the vertex Shader based on the height map right so 
[01:48:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6487) we're going to do that and like I mentioned before these are scanned this is scanned data and quixel actually provides a height map for this texture so now we have a way of telling how high 
[01:48:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6501) is a certain point in this texture and how low are the other points or rather we know the lowest point and the highest point and we have a normalized value from for that between zero and one right 
[01:48:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6512) um so um so we're going to use this texture all right so let's go back to the Shader we're going to need to add a another texture we have Rock Albedo Rock 
[01:48:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6525) normals and now we're going to need Rock Heights how hard is it to get a normal map from a height map and vice versa you can get a normal map from a height 
[01:48:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6534) map relatively easily and what you need to do is to do a partial derivative where you basically detect the slope of the height it can be difficult to do it properly though because of texture 
[01:49:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6545) compression that derivative is only going to be accurate if there's no compression and textures are usually limited to 256 steps um so it's sort of a stair Steppy way of 
[01:49:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6556) representing height so usually you need pretty like accurate height maps in order to get an accurate normal out of it converting from a normal map to a height map on the other hand is really 
[01:49:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6568) really difficult and weird and it's going to be like a strange goopy iterative process I have done that in the past it was not super good but you can sort of do it I actually did that as 
[01:49:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6580) a freelance gig for quixel so that's relevant um but yeah it's kind of difficult so so generally um 
[01:49:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6588) oh yeah all of this would generally be something you do offline you bake that to a texture and then you read from those textures okay rock height 
[01:49:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6597) all right default value for this so this sort of depends on how we want to interpret the height map uh do we want zero to be like do we want this height to be zero or should this be one 
[01:50:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6609) in other words um should this extrude upwards or should it extrude downwards or do I want it to be centered um I think I would prefer this to be 
[01:50:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6618) centered um so in this case I want the default to be gray which would be middle gray like 0.5 would be no offset in this case so that's Rock height and then we can go 
[01:50:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6632) back to the actual Shader code we're going to need to add Rock height here uh and then we should assign the height map 
[01:50:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6644) there we go this looks a little gloomy maybe we should turn this into a directional light so we have more okay um so now we have the rock height sampler 
[01:50:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6656) and now we can sample from this height map in order to know how far we should offset these vertices right okay so previously we know that we can offset stuff in the vertex Shader right 
[01:51:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6668) so if we are in the vertex Shader then we can offset offset this vertex value before we do anything else with it right so for instance maybe we want to modify this one 
[01:51:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6681) um so maybe we add it on the y-axis plus equals um like I don't know cosine I dot UV ogs V Dot UV dot X 
[01:51:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6696) um plus time dot y there we go and that's too harsh there we go so for instance we can do stuff like this where we offset the 
[01:51:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6712) vertices and again this happens in the um this happens in the on the GPU itself this does not modify the mesh data at all this is only for when you're rendering this 
[01:52:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6726) um should also tighten this up a little bit um there we go so we did this previously when we were looking at water right 
[01:52:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6733) because this was a simple way of adding waves to your stuff um now in this case I'm just adding to the Y component of the um of the vertex so 
[01:52:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6745) you can see that this one is also moving upwards uh same thing with a sphere it's moving upwards and downwards but what we might want to do instead is that we might want to use the normal direction 
[01:52:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6754) of the surface so instead of offsetting upwards we're going to offset along the normal itself of the mesh so instead of doing a DOT y plus equals we're going to take this 
[01:52:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6768) wave component and we're going to multiply that by the local space normal so now this is going to happen along the local space normal and that's going to be added to the vertex position I guess 
[01:53:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6780) that's a lot cheaper than moving every vertex on the CPU yes very much so this was not valid uh right V Dot vertex.xyz because it's a four component value 
[01:53:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6793) there we go so now it's extruding along the normals instead so you can see that the um this one can now move on the x-axis as well and not just like on the height 
[01:53:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6805) axis so now we have this like weird wavy things gooping around but we want to do this based on a height map and not just a wave over time or whatever right okay 
[01:53:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6818) um how cheap is it it's very cheap to do this gpus have no problems doing this moving the vertex um there's there's no additional cost to moving a Vertex apart from just doing 
[01:53:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6831) the math um because it has to like it has to place the vertex somewhere anyway um and if you just change that position it's still going to do the same 
[01:54:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6840) positioning math right okay will there be tessellation too this plane is already tessellated which is why we're getting these waves right so if we look at the wireframe you can see 
[01:54:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6850) that the wireframe that this is already a tessellated plane we're not going to look into a GPU based Dynamic tessellation if that's what you're asking but you can do that as well you 
[01:54:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6862) can make it so that you have a quad mesh and then on the Shader you make a geometry Shader or a whole shade or a domain Shader and then using those you can create geometry on the GPU we're not 
[01:54:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6874) going to do that this is a pre-testylated mesh so this already has all of the vertices right so in a quad you would just get like these two triangles moving like this right okay 
[01:54:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6886) but we don't want to move it like as a wave along the UV coordinates that's that's not what we wanted to achieve uh we wanted to use a height map to displace this right 
[01:54:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6897) um so in this case we need to sample the texture in the vertex Shader um so in this case we would need to assemble the height so it's called floats Heights 
[01:55:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6910) and we want a sample from Rock height at v.uv because we're directly reading for the mesh data um oh actually we should probably use the 
[01:55:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6924) these units because we we scale the UVS depending on the um like the scale offsets inside the material itself so we want to make sure that the height map is also sampled uh 
[01:55:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6934) using these offset UVS right so we're going to use o.uv in this case um okay so we don't want to do this wavy thing but we are still going to extrude along 
[01:55:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6947) the normal that's the direction we want to move this in okay so we got the height here uh we this is just a grayscale texture so we just do dot R for the single components r dot X same 
[01:55:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6959) thing um and then we want to offset the normal based on this height and the height is just a magnitude at which we want to offset along the normal and with regular 
[01:56:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6970) Vector Mass multiplying a direction by a magnitude makes that Vector have that magnitude right um okay so we're now offsetting this based on 
[01:56:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6982) the height map now keep in mind that this is this is a value between 0 and 1. and so one if we don't scale the object it's going to be one meter which is huge 
[01:56:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=6995) that's the same as the width of this whole object so we probably want to have some sort of intensity parameter for this too like height intensity so or displacement intensity 
[01:56:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7007) or displacement strength I'm going to use strength now because why not so displacement strength or disc strength 
[01:56:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7016) and we'll go back to the Shader add the property there displacement strings I'm going to make this go between 0 and 0.2 um because start at zero 
[01:57:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7032) there we go so we've got displacement strings as a value we can read from so now we want to scale how strongly we do this height offset now this is between zero and one 
[01:57:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7045) and again it depends on if we wanted to only move the vertices upwards or if we want to only move them downwards or if we want to make them like go in both directions I think I would prefer to 
[01:57:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7057) have them centered like I mentioned before so I would like to remap this from 0 to 1 to negative one to one and that's a relative illustrator process multiply by two subtract one 
[01:57:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7069) okay now um we might get a compiler area here I'm surprised it's not yelling at me already but oh actually what else I need to use our displacement strength sorry uh so so 
[01:58:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7082) once this is between negative one to one uh we can just multiply the height by the displacement strength um actually maybe we should do that here okay now generally if you are sampling 
[01:58:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7099) Textures in the vertex Shader um text 2D automatically picks the MIP level for you but in the vertex Shader it can't pick it automatically because it doesn't know like at what mid level 
[01:58:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7114) we want to pick this because it doesn't have any like fragment data to determine uh what level it should go for so usually when you're in the vertex Shader you need to use a function called text 
[01:58:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7126) 2D load where you basically um you pick the mid level yourself instead of instead of like automatically having that get picked for you in which case with this is a float4 parameter 
[01:59:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7141) where the first two components is the UV coordinates or the coordinates you want to sample it at um the second the other two components are 
[01:59:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7149) the mid level you want to sample it at which is going to be 0 for both of these zero is the highest detail one uh one is the next MIP level that is downscaled and so forth so this is gonna this is 
[01:59:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7163) gonna just sample a specific mid-level uh specifically MIP zero can you use Dynamic tessellation to add vertices around the edge of an object where the displacement is most noticeable 
[01:59:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7173) um yes you can do that I think it gets a little complicated I haven't written that many um geometry shaders myself I think that 
[01:59:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7183) one of the tricky things is that you usually do this per triangle I think you can do it on a per quad basis if the mesh is set up that way but I haven't written many of those shaders myself 
[01:59:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7193) because geometry shaders are generally expensive and most people don't use them um so yeah uh yeah so it's mid level on the x-axis mid level on the y-axis and this is because if you have anisotropic 
[02:00:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7208) filtering on your MIP then you can have these be different if you want to pick some of the like Direction specific mips um all right so now we have our Heights we're 
[02:00:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7221) sampling it from the texture we're remapping it from 0 to 1 to negative one to one and then we're multiplying that by the strength of the displacement so if the strength is zero this is going to 
[02:00:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7234) add zero right um and then we can increase the strength we can increase the strength if we want to do that um okay so now let's go back to Unity 
[02:00:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7247) recompile and go to our Shader I'm going to change the tiling um all right so we got our displacement strings and if we pull that we're now changing the geometry so this is now 
[02:01:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7261) offsetting all of the vertices and like you can see if we go to wireframe this is now based on every vertex so this displacement is happening happening in the vertex Shader so that's moved 
[02:01:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7274) first and then the fragment Shader does exactly the same thing it did before um and yeah so now we actually have these like cliff-like structures parallaxing because it's actually 
[02:01:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7287) um it actually has that geometry there right worth noting though is that if we displace in this way but we don't have a normal map the normals are not going to get updated just because we move the 
[02:01:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7301) vertices this is really really important to know because if you do any kind of like waves or something in your vertex Shader the normals are not going to adapt to those wings the normals are 
[02:01:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7313) just going to point the same way they did before unless you tell the normals to also be different right so it's an important thing to to note that it's yeah things work slightly differently 
[02:02:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7324) there because they're all still like independent of each other yeah and this works uh for the sphere as well because it's extruding along the normal uh it's not hard-coded to extrude upwards 
[02:02:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7335) um so everything's still works as you would expect it to although this could use some more triangles but some weird clip of stuff on the cube at the edges yes 
[02:02:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7345) um here's here's a here's a good quiz can you guess why this happens this is an interesting point I feel like we talked about this before uh during the or did we talk about this during the 
[02:02:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7356) math class maybe we didn't actually we did okay cool basically the the um the problem with extruding along normals is that anything that is hard edged 
[02:02:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7368) um is going to separate so if we if we consider a cube um like how many vertices does a cube have um so in some sense you could say that 
[02:02:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7379) well there's four at the top four at the bottom so this would be uh eight vertices right but it doesn't actually have eight vertices because generally a cube requires you to 
[02:03:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7393) have three different normals per vertex right we need one normal pointing up for this surface right here we need one normal pointing in this direction for this surface right here and a third one 
[02:03:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7405) for the back face that we're not seeing on the back side here every vertex in a cube if it's hard edged needs to have three different normals at a single point so what that means is that we 
[02:03:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7417) actually don't have eight vertices we instead have three vertices at every corner um so this is actually eight times three vertices which I'm sure is some exciting 
[02:03:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7427) number I'm really bad at doing math in my head so it's 8 times 3 vertices so that's how many vertices you have and so when we do our displacement the way that we did that was that we have some vertex 
[02:04:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7440) we have a normal Direction and this is the edge of the cube so that normal direction is actually incredibly invalid there we go so when we extrude or move something along the normal what's going 
[02:04:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7454) to happen is that these three faces are going to move in three separate directions right so that's why just extruding by the normal is going to make them separate from each other so moving 
[02:04:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7466) this out is going to create a gap that one's going to move all the way over here this top one is going to move all the way over here and then we now have a gap there so this is a very common issue 
[02:04:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7477) if you want to do something like sometimes outlines for instance um if you want to make like an outline Shader a very common way of doing that is to extrude the mesh and then flip it 
[02:04:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7488) and this works as long as it's not hard edged but if it's hard edged then it's going to separate like this what does hard edged mean it means that you have normals that are pointing in different 
[02:04:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7499) directions at a single location so if you have a Shader like this or a mesh like this and the normals are pointing let's see let's say let's say this is actually three vertices 
[02:05:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7512) things interpolate across the triangles right so these normals are going to interpolate sort of like this right so they're going to blend between these normals and the fact that they 
[02:05:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7522) interpolate makes the perceived appearance of this shape look as if it's smoother than it actually is right so that sort of gives us more of a smooth path like this because if we shade based 
[02:05:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7536) on the normals it's going to look as if it's smooth because of the fact that these interpolate which kind of matches that curve underneath right that's why it looks smooth and that's why sometimes 
[02:05:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7547) you call that a smooth shading or a smooth edge here but if you want hard-edged stuff the way that you make something hard edged is that you split this vertex into two so now there are 
[02:06:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7560) two vertices here instead of one where one vertex is connected to this triangle the other vertex is connected to this triangle and they now have two separate normals so now you have diverging 
[02:06:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7573) normals at a single point so now this one is going to look flat and then there's a discontinuity here so that's a hard Edge there's no continuity in lighting because we're switching normals 
[02:06:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7583) immediately and then it's shading this flat as well so yeah so this is the hard Edge the more General concept is a um sometimes they're called split 
[02:06:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7595) normals sometimes you can call them split vertices in general and a Vertex split can happen for many reasons um you know if you your UV coordinates 
[02:06:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7605) you might have the same normal here but you might have two different UV coordinates and then you now need to duplicate that vertex and make it make it connect in a different way so having 
[02:06:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7614) seams in your UV map for instance is also going to create a duplicate vertex there how do you make triangles if you only have two vertices that are connected to each other 
[02:07:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7624) um oh this is imagining triangles behind this so if you imagine more geometry than just this um yeah I'm just showing this in 2D because 
[02:07:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7634) it's easier um to like visualize it but generally this would be uh you would have more vertices here as well if that makes sense okay so that's why it splits 
[02:07:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7643) that's why we get this weird effect all right this is a very intense displacement there we go any any questions using height map on a sphere will also 
[02:07:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7654) split the mesh right yes as long as there are discontinuities in the um in the normal Direction and usually the UVS as well then you're going to get 
[02:07:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7663) a split here right at the poles of this one but you're not going to get a split around the mesh itself because the the texture is tiling and it's offsetting the edges at the same 
[02:07:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7675) at the same distance is there a way to displace a sphere without splitting it um you can but then your displacement needs to be based on something other well like it depends on like how would 
[02:08:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7684) you set up your UVS in that case it is possible as long as your normals are consistent um and that the the sample height is the same at this pole and we can see that 
[02:08:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7695) it's not the same here right so we need to make sure that you map the texture in a way where that is the same um but it gets complicated um I guess the way you could do it is if 
[02:08:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7705) you have for instance um so we haven't talked about Cube Maps yet but it's a relatively simple idea of a cube 
[02:08:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7716) map is a texture that sort of has multiple parts that map to a cube so a cube map is a texture that contains six different faces and then instead of sampling this 
[02:08:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7729) texture by using 2D coordinates you sample it using a vector so it's a vector from the center and then you give it a direction and then whatever side of the cube map happens to be there you get 
[02:09:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7741) the color from that one so that's a cube map and there are many many different ways of doing that and the usual use case for a cube map is a Sky Box so you might have seen like Skybox textures 
[02:09:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7752) where you sometimes it's it's in a like heavily inefficient layout sort of like an unfolded dice right something like this 
[02:09:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7764) there we go there you go so this would be all the six faces and then you would have the the sky mapped out on this so you know you would have some the blue beautiful sky wow what a what a neat sky 
[02:09:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7776) and then you would have some some ground on the bottom side or whatever so this would be sort of like how a Skybox could look but yeah so if you if you can make a height map that is a cube map as in 
[02:09:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7790) you make a cube map that contains height information then yes you could do that it's a spirit split because the poles have four vertices and because UV Corners end there and it just isn't 
[02:09:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7798) seamless it's because the I believe it's because the UV coordinates are different along all of that one or along that pole because it's split with four different UV coordinates 
[02:10:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7810) um and those UV coordinates sample different heights so that's why the heights are different right oh there is also a a another way of doing Cube map like stuff sometimes you can encode an 
[02:10:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7822) entire Cube map in a single texture as well so you have like your entire sky in a very warped single texture sort of like this usually it's like two by one yeah could you 
[02:10:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7834) displace the vertices without using the UV and instead use their world position or something the the problem then is that um the the question is where do you 
[02:10:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7843) sample your height map because now we're sampling the height map using the UV coordinates and if you're not using the UV coordinates what are you going to use to sample that you could sample it using 
[02:10:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7855) World coordinates but your normal map is not sampled using Word World coordinates now it's going to be like you're going to disconnect those two so you need to sample your normals and your height map 
[02:11:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7866) using the same coordinates right or using the same coordinate system so it gets really complicated so you need to like line up all of those things where all the maps you're using has to use the 
[02:11:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7877) same projection and mapping what about a case where we don't need a height map just get some waves along the mesh as long as the coordinates you use to generate the wave are continuous then 
[02:11:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7888) you're good to go that's basically the answer like you just need something that is continuous and not discontinuous right so that when you sample it you don't have that break so if you make 
[02:11:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7899) those waves using UV coordinates if there's a break in the ubicornet somewhere then there's going to be a break in your displacement too oh someone's asking about the Google 
[02:11:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7909) lock for exercises um I'm probably going to add some minor exercises to the same document yeah I'm not going to create a new one um if you're using World coordinates it 
[02:11:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7918) would only work for like quads right because spheres Etc would look wonky uh yeah because then if you use World coordinates then like what is that based on right like is it is it a top down 
[02:12:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7931) projection for where you want to make your waves move across you can make it an angular or like a polar coordinate if you want to but then the waves are going to go around it and maybe that's not 
[02:12:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7941) what you want so all of this depends on what you want to achieve right and the space you need to run all of that at also depends on that right so there's no way to like magically fix this 
[02:12:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7952) um and you you sort of need to think exactly about like what is it that you want to achieve what space do you want to animate this in and so forth Google doc so I'm just going to link it it's 
[02:12:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7961) also on my Twitter and just tweeted about it in case you're following me there uh can I do that in shaders depth of fields yes uh but depth 
[02:12:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7970) of field is kind of a complicated thing uh it's really hard to pull it off well um so yeah have you used depth of field much no not not much myself I have done a few things that involve uh doing like 
[02:13:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7984) gaussian blur but not specifically depth of field effects okay this is visible for me I don't know if it's going to be visible for you hopefully this is such a subtle 
[02:13:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=7996) effect and it's probably going to autofocus on this like slightly the wrong part it's kind of visible we're looking at this colored specular thing uh kind of yes 
[02:13:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8006) uh I was thinking we would go into image-based lighting or IBL and colored metal have a really really interesting like effect when it comes to the when it comes to for now uh which is kind of 
[02:13:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8018) neat it's not as visible on camera as it is in reality but how heavy asses are how heavy I don't know how to measure that it's a post effect you can sort of filter SSR to not 
[02:13:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8033) be affecting all the pixels SSR is like sort of basically should I just open Final Fantasy and show you how it looks because I'm in control you know what I'm gonna do that oh I'm on speakers 
[02:14:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8045) uh where do we find water uh can't use a twitch stream priority queue button you know I wish I had that what's your pet's name you can't name your pets 
[02:14:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8056) um it's a box it's a little it's called Fox kit okay it's a night that might be good or bad usually Reflections are very visible if you have like bright things reflected 
[02:14:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8067) when it's dark out as far as I know I don't think there's a faster way to get there I'm sorry this is an educational stream I promise okay 
[02:14:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8076) uh this water I don't know if that one has strong SSR or it's not very visible there oh it's very dark oh no this is not going to be very clear okay there we go uh is are the Reflections in the 
[02:14:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8090) water visible I feel like this should be visible right you can see that they sort of Parallax along the water right um so kind of a funny thing you can do 
[02:15:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8102) to detect whether or not Reflections like this are screen space based um is that because you can see these Reflections here right but if you turn your camera up like this you can see 
[02:15:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8115) that the reflections kind of get cut off right like it sort of disappears along a line here so now there are no Reflections here and they kind of disappear when you move your camera and 
[02:15:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8125) that is because the um these Reflections are just based on what we've already rendered in screen space um so we have this reflection right here 
[02:15:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8138) and that is based on we've already rendered this island and then in screen space we can we can take the normal of the surface and we can sort of shoot array from the screen and bounce it off 
[02:15:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8151) of that surface and then instead of like raycasting through the world we're raycasting in the depth buffer because we've rendered things into the depth buffer right so then we can March array 
[02:16:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8163) through the depth buffer until we hit something and when we hit something we can grab the color of of the stuff we've already rendered so that is very likely what they're doing here so that's called 
[02:16:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8174) SSR or screen space reflections because then yeah the limitation is obviously you can only show stuff in the reflections that you're already rendering so they get cut off if there's 
[02:16:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8187) nothing to render obviously so so quite often games have um games have a fallback where if the ray misses then it's going to fall back to 
[02:16:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8200) using a cube map or a generic environment map instead so you can sort of like mix different techniques in order to yeah in order to sort of like counteract the side effects of this type 
[02:16:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8212) of reflection um but yeah um so it's kind of neat um you can also do stuff like if you want this to be a little bit more optimized you don't have 
[02:17:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8220) to do this at full resolution resolution you can do this at like you know half resolution or whatever depending on how blurry or refractiony the reflections are but it's kind of a neat little trick 
[02:17:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8231) to to get these types of Reflections if you want to do this properly as in you want to be able to render all the stuff on the cliff over there without using like screen space effects or 
[02:17:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8244) whatever now you need to actually render that data somehow right and how do we get the data without rendering it well you can't you have to to render it so quite often when you want these types of 
[02:17:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8256) like planar Reflections and you want that to actually be real time instead of just using the screen space hack you need to set up another camera that can render the reflected version of the 
[02:17:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8267) world and then you can try to like call and cut away things you don't want to render so you basically render another time just for the water or any types of like planar Reflections like that so it 
[02:18:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8280) is possible to to properly render that data but it's pretty costly because you're going to do you know another render pass and every time you render from a camera that 
[02:18:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8290) camera has to do occlusion calling to make sure that it's not rendering literally everything in the world so there's a lot of like steps involved to do that and it can be 
[02:18:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8299) um it can be very expensive to do that yeah anyway so so screen space Reflections is a nice little hack that can kind of cover up for um many of the reflections that are 
[02:18:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8308) difficult to do otherwise um if you like those glowy orbs should be better reflected in the water so God damn it I'm not there anymore the reason the glowy orbs are not reflected in the 
[02:18:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8318) water is because those glowy orbs are rendered with um they're like Alpha Blended right or additive um so they're going to be transparent 
[02:18:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8328) and like I mentioned before with this type of like screen space Ray marching is that you're remarking the depth buffer and if you remember um transparent objects do not write to 
[02:19:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8342) the depth buffer so anything that's transparent or additive or multiplicative like VFX is usually like under all of those categories uh then generally those are not going to be 
[02:19:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8353) visible in those types of Reflections because the they don't write to the depth buffer so it's only based on whatever is writing to the depth buffer which is useful usually like stuff 
[02:19:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8363) that's opaque rather than transparents um and there are no can't find many transparent things here apart from the bubble on top of the the quest icon um but yeah so that's why that wouldn't 
[02:19:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8374) really be visible can you fix that somehow um I mean sort of um you can you can like you can grab that color after transparent objects has 
[02:19:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8383) been rendered but the problem is that the transparent objects are going to be at the wrong location so you're not going to get that proper parallaxing effect that you want 
[02:19:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8392) um so otherwise not really it's kind of hard um like you would need a proper reflection Source like that like rendering another camera for instance is 
[02:20:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8404) that the kind of thing deferred rendering might help with no it would help but only because having transparent objects in different rendering is difficult how do you rotate the material 
[02:20:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8412) or color on the surface of the object um so what do you mean by rotate color I presumably mean rotate the this texture in general right um well the way you would rotate 
[02:20:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8423) something like this texture is that you need to rotate the coordinates that you sample the texture with right um because there are no objects when you're in the fragment Shader or 
[02:20:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8434) whatever um so you would you would like actually do a rotation mathematically in the coordinate system itself we can do that if you want to if you want to see how 
[02:20:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8442) that works where's our Shader it's probably there we go um depending on if we when I'm like doing a 
[02:20:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8456) swirling thing it means we would have to do this in the vertex Shader or in the fragment Shader but if you just want to do a straight up rotation then we would need to rotate the UV coordinates 
[02:21:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8466) because this is what we're using to sample the textures right so in order to figure out how to do that I'm going to go to my math Library um 
[02:21:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8479) let's see uh I want the um it's going to be in extensions rotate there we go head back to our Shader 
[02:21:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8499) perfect I do have a math Library yes uh all right um so if we just have a simple rotate 
[02:22:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8524) function that takes a vector and rotates that Vector we can then rotate that by some value um so the in this case we would want to rotate the 
[02:22:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8537) um we would want to rotate the coordinates that we use to sample the texture so sometimes that can feel a little backwards because we need to like we're 
[02:22:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8546) kind of rotating the domain rather than like sampling something and then rotating it but we need to rotate before sampling so if we have UVS here we can do rotate 
[02:22:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8558) or like o.uv equals uh rotate o dot UV and then we give it some sort of angle I'm just going to do time.y um 
[02:22:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8573) there we go and then now it is indeed rotating this texture around zero um which is a little trippy 
[02:23:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8585) um especially with uh you can see this like jaggedy uh vertices move around and like jiggle um 
[02:23:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8594) but yeah um there you go this is hypnotizing oh yeah if you want to rotate it from 
[02:23:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8607) the middle it's the same as the other Vector math we've been talking about uh where um like you make the vector relative to the pivot and then you rotate it and 
[02:23:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8617) then you make it relative to the parent space that you had before in which case I just subtracted 0.5 and added 0.5 so this would be a relative Vector relative to the center 
[02:23:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8628) because 0.5 is going to be cast to a floats two that is 0.5 on both components um so we're going to center it and we're going to make all the vectors relative 
[02:23:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8639) to the center of our UV space then we rotate them and then we're going to move them back to where they were before um so that's what we're doing here um 
[02:24:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8651) yeah okay um [Music] oh you wrote in chat sorry I'm not 
[02:24:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8658) reading twitch chat very closely um [Music] all right let's go to photoshop I think that's a good start 
[02:24:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8673) no photoshop's not a good start never mind we're not doing Photoshop we're hopping immediately into Unity again where are our light sources just gonna delete a few things is this our only 
[02:24:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8685) light source now yes good there's one thing that we haven't really covered when it comes to lighting which is a pretty important part um and usually 
[02:24:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8696) um this is something that for me whenever I look at projects um one of the like telltale signs for me that um there are like inexperienced people 
[02:25:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8706) working on something or people are new to game development that gives like projects this kind of um the student game look for a derogatory 
[02:25:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8716) version of that one of the things that I quite often see is this type of pitch black color so this happens because we are only caring about specifically the one 
[02:25:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8729) Dynamic light source that we have here and we don't have any any light coming in from other directions you tend to have these very very very harsh Shadows it looks especially bad if you have this 
[02:25:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8742) type of thing with vegetation in like trees or even worse in grass so a big component that we're missing is ambient light so light coming in from all directions that affect the way that 
[02:25:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8755) this one looks um so I was thinking we could go like through uh kind of the level one ambient light and then we're gonna do level two and level three 
[02:26:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8764) um so the um sort of the the most base most basic form of ambient light that you can add to something 
[02:26:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8772) um is to Simply add a color uh all over your object so so let's start by adding the the most basic form of ambient light that you can add so let's go to the Shader there we 
[02:26:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8784) go um so we got our Shader and we probably want to have a parameter so we can control the ambient light uh probably in like a real world case this ambient 
[02:26:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8795) light would be a global property and not a per instance property but for now we're just going to do call this ambient light there we go 
[02:26:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8806) um and this one we want this to default to zero because we probably don't want it to contribute by default and then we set some value later all right so we go back to our Shader 
[02:26:58](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8818) code and we add it to our our uniforms so now we have ambient light and one thing that is important here now where we need to consider the way that 
[02:27:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8833) this Shader is used because this Shader is run once per light source and if we are adding light that's coming from all directions we need to make sure that we only add that once we don't want the 
[02:27:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8845) ambient light to be stronger when you have more than one light source right so this is a case where our little Define here is going to be really useful um 
[02:27:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8856) okay um so the the most basic way of setting up ambient light is to add that to your diffuse light because our diffuse light is now uh currently this picks up the 
[02:27:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8872) direct light source but the ambient light is indirect light but that's also going to be part of the diffuse light so we're we have our direct light already now we need to add the indirect light 
[02:28:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8883) and that's our ambient light so we're just going to add this to the diffuse light so diffuse light plus equals ambient light so this adds the indirect diffuse 
[02:28:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8894) lighting okay but this should only happen in the base pass otherwise again this is going to happen for every light source but the ambient light should only be applied 
[02:28:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8906) once per object so in this case we also want to add the branch based on our Define so if we are in the base pass then we want to do this otherwise we don't want to do it 
[02:28:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8920) so if we go back recompile so now we have our ambient light property so now we can add some ambient light to this and this already looks much better now we don't have this like 
[02:28:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8931) extremely harsh shadow um we can also make the ambient light have some sort of color to it so it's not as um so it's not as monochrome so now 
[02:29:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8942) everything looks a little bit more filled right and it looks a little bit more realistic and not like extremely harsh obviously if you have too much ambient light things tend to look very 
[02:29:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8950) flushed out so you want to be careful on how you apply ambient light and so forth um now there there are obviously many different ways you can apply ambient 
[02:29:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8962) light this was is kind of the the most basic uh straight up way of doing ambient light where you just add that as you know uniform light coming from all directions 
[02:29:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8972) um hitting your objects now in the real world uh ambient light does not work like this at all um ambient light is generally whatever light is around you in the environment 
[02:29:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8985) is what is going to be coloring your object and then bouncing off of that object um so you you're like quite often you will see people use like a blue-ish 
[02:29:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=8995) color for ambient light and the reason that blue is a very popular ambient light is because usually the sky is blue so what that means is that when the sky is blue wherever there's no direct light 
[02:30:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9009) source the sky is going to be the biggest contributor to the color of that part of the object um so so quite often what um what your ambient light is coming 
[02:30:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9020) from is just light bouncing off of the rest of your scene right which quite often has a blue sky therefore blue ambient light is very common uh but there are other ways we can apply 
[02:30:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9033) this type of lighting more specifically we can use an actual Skybox to apply lighting to this object so um and and this concept is usually called image image based lighting as an 
[02:30:50](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9050) IBL because it's based on using textures that contain environment data that is then going to be used to light your objects so 
[02:31:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9061) uh so we're gonna do that I downloaded a pack of a simple sky here you go this is this guy so when you download like Skybox and whatnot Sometimes they come in the form 
[02:31:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9075) of a cube map Sometimes they come in the form of a rectilinear map like this one um so this is a full 360 view of a single scene you can see that it's it sort of fits a whole sphere you can see 
[02:31:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9088) that it's under an arch and it's tiling on the x-axis because it repeats itself right so this is a full 360 view of a scene it just so happens to be encoded in a rectangular texture right so we can 
[02:31:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9102) use textures like this to sample our lighting see if we can make this bigger quite often you want to separate your specular lighting from the diffuse lighting so in this case I have two HDR 
[02:31:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9119) Maps this one which is very sharp and I have this one which is very which is very blurry um and I don't know if I can zoom in on this I don't think I can but it's a 
[02:32:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9129) blurry version of it um and one thing that is special about IBL is that quite often when you make these blurry versions you actually have to do some extra math to make sure that 
[02:32:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9141) it's not just a gaussian blur but rather it actually does a convolution pass where it collects the light and makes a properly a proper light kernel around all the stuff you have there can you set 
[02:32:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9155) up a camera in unity to render that image from your scene what we can do is make a Skybox Shader that's showing this in the background instead of unity's default Skybox like 
[02:32:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9165) this um I we could do that if you want I haven't done that in ages but I'm pretty sure I know how to do that we can try if you 
[02:32:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9174) want to I don't think it's going to take that long okay let's do that it's it's a good starting point is there a function for Twirl in hlsl unity shaders what do you mean by twirl if you want to make 
[02:33:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9184) like a spiral effect uh then kind of what you're doing is that you're rotating the coordinates but you want to rotate more the further away you are that's the way you get the spiraling 
[02:33:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9196) effect right so all you're doing is just rotating the coordinates and that's kind of it um okay let's let's try making a Skybox Shader 
[02:33:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9206) it'll it'll be great uh Shader unlit uh that did not actually create a file for some reason okay uh FG even Sky there we go and then when he created the material 
[02:33:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9221) and then we can go to the lighting settings of the scene and then where do you set the Sky Box environment there we go FG Skye what a beautiful 
[02:33:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9233) Skybox mm-hmm okay so all I need to do then is to sample this rectilinear um texture right 
[02:34:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9246) so let's see uh we don't want fog in our Skybox in this case it's actually important to remove fog um and we do have a texture that we're 
[02:34:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9256) sampling there in the UV coordinates I have no idea what UVS Unity is using for the Skybox mesh um I imagine uh it's just going to be a quad in the background 
[02:34:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9269) um but let's try outputting the UVS return float4 um I Dot uv01 uh it looks like 
[02:34:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9284) oh this is really useful actually it looks like the UV coordinates we're getting is the view Vector right um if we look up we get green if we look 
[02:34:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9295) along the x-axis we'll get red uh but blue isn't not showing because I didn't include that okay so it could be that UV is a three Channel thing 
[02:35:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9308) in which case I don't care about texture mapping this um so let's see it's a float three float three 
[02:35:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9320) uh yes okay so this means that the the UV channel is used for the view Vector in in the mesh that's rendering the Skybox Shader so that's useful okay 
[02:35:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9334) um yeah then we have most of the stuff worked out and then we want to sample the texture using these UVS um so we're going to take the sky texture 
[02:35:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9345) which there are three versions I think one is meant to be used as a Sky Box the other ones are HDR that are meant to be used in the Shader itself for the surface 
[02:35:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9357) um so we're gonna go for the Skybox one um to replace this mango there we go and then we actually need to read from this 
[02:36:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9368) texture now this UV is actually the view direction right so I'm going to rename this to um 
[02:36:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9378) view Direction [Music] um so we can't just sample this texture using that view Direction it's going to 
[02:36:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9391) look interesting but it's not going to be what we want um so I'm pretty sure this is not what the outdoors looks like when we go out so this is in fact incorrect 
[02:36:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9406) um okay so if we look back at the texture this one then this one is not actually using a view direction right this one has 
[02:36:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9419) encoded all of the directions we can consider into this square right and what we have here is that along the x-axis we have the um 
[02:37:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9431) the lateral rotation right like rotation along um a flat ground rotation around the vertical axis right and then on the y-axis we have the sort of rotation 
[02:37:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9446) along the y-axis but it's between zero to one and so what we need to do is we need to have a function that can map from the um from a direction to a coordinate in 
[02:37:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9459) this space but we've done this math before because this is stuff we covered in the math course um so let's let's make a function so floats to direction to rectilinear 
[02:37:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9476) and this one is going to take a Direction all right uh so we'll basically have two coordinates with the x coordinate and 
[02:38:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9484) the y coordinate so let's start with the x coordinate so float x equals um so this is the direction that you're looking from a top-down perspective um and if you're familiar basically what 
[02:38:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9496) we're doing is we're taking a projected Vector as in a top-down 2D vector and when you want to convert that to an angle right so we use a tan 2 to do that right it's a 2d Vector it's Direction 
[02:38:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9510) dot XZ sorry um and then oh sorry we're gonna have to do uh Direction dot Z and then Direction dot X 
[02:38:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9522) um so now we're going to get the horizontal coordinate from that but uh this one is going to be from uh negative half tail to uh positive Tau right um 
[02:38:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9534) positive half time there we go which is not great we don't want that range we want this to be normalized between zero and one right um 
[02:39:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9544) so um where's our time constant rg's we still don't have a math library for this I feel like I should learn Tau to like five digits at least 
[02:39:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9557) there we go all right um so what we need to do is if we divide this by Tau uh then this is going to be from negative 0.5 to 0.5 and then after 
[02:39:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9580) we divided we add 0.5 so now this is going to be from 0 to 1. okay there we go so we got the x coordinate hopefully this works um and now we need the y coordinate and 
[02:39:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9594) the y coordinate is actually uh very simple uh we have the direction and the y coordinate is going to be the direction dot y but this is from negative one to one we 
[02:40:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9607) want to remap this from zero to one so we're going to multiply that by 0.5 and add 0.5 and that makes this 0 to 1 as well 
[02:40:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9618) and there we go return flip two x y uh if we were using a cube map then this would be easier a cube map already samples with a direction then we don't 
[02:40:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9632) need to do this whole remapping thing but if the Skybox was a cube map then all we would need to do is use a texture sampler for queue maps and then pass the direction in with it but in this case 
[02:40:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9643) it's a rectilinear Skybox so we need to do that conversion um okay um so now we should be able to use our 
[02:40:53](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9653) direction to erect a linear coordinates pass that in and now we should get a proper Sky out of this um this looks relatively reasonable 
[02:41:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9665) let's see if we can bump up the text or the resolution on this one hell yeah there we go that looks pretty okay uh except for 
[02:41:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9678) this part which is because of mip Maps and partial derivatives so we can we should probably do text Duty LOD in this case 
[02:41:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9689) um if we just want to get rid of that um then we'll do float4 this is a bit of a hack so I just want 
[02:41:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9700) to get rid of this ugly seam here there we go now it's gone uh okay go back here so now we have a a simple background it's this little desert 
[02:41:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9715) environment and obviously the lighting doesn't match uh this object at all we would expect it to have a blue ambient light coming from from a big part above it right and then orange ambient light 
[02:42:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9728) from the bottom because there is at the ground obviously reflects light otherwise we wouldn't be able to see it and that light will also hit this object so we're now going to take um we're not 
[02:42:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9740) going to use this as a way to light this object with ambient light okay so uh we might want to steal this function so we're going to steal that and 
[02:42:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9758) uh let's see I wonder if we should do this in the same Shader or if we should start in a clean Shader probably okay to put it in here just need to redefine towel there we go 
[02:43:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9783) um okay so previously we added the ambient light here uh this is in the base pass we added the ambient light to the diffuse light we might want to make this based on that image instead 
[02:43:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9797) so so first we obviously need access to that um Skybox so we're going to go back to the Shader we're going to add another texture 
[02:43:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9806) so this is going to be the uh we can call it diffuse IBL for image based lighting diffuse IPL and probably want to default this to 
[02:43:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9820) Black so that if you have nothing applied it will add nothing to it otherwise if it's a white then everything would just go really bright and we probably don't want that so we 
[02:43:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9829) got diffuse image based lighting and then we also need to add that in amongst our uh uniforms uh all right so I've diffused IBL and 
[02:44:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9842) yeah okay so we should probably just try this out to make sure that it works let's see how do we do this I guess it's better if we just do this diffuse IBL on 
[02:44:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9852) its own so now I'm just gonna um mural there we go div uh 
[02:44:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9883) foreign I just want to make sure I just wanted to set up a debugging environment that's going to work with our multiple light sources 
[02:44:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9892) okay is that was that the name we gave it use lighting what's the other one right and then it's in base pass okay there we go beautiful um all right 
[02:45:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9907) so now we can start experimenting with this now the direction we want to sample this ambient light in is going to be the normal direction of the surface because now the if the normal is pointing toward 
[02:45:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9921) the Blue Sky we probably want to sample the blue color from there if it's pointing down into the like orange rocks then we want to sample Orange from there and then add it to this object so when 
[02:45:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9933) we want to do diffuse image based lighting it's going to be based on the normal and we have the normal in I dot normal which is the vertex normal we're going to use the other normal later but 
[02:45:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9944) just for just to show what it looks like um then we have our diffuse IBL so we're going to do a text to your team 
[02:45:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9954) are we going to end 1400 today because decided we didn't have much time left earlier um yeah this is going to be a little tight I'm sorry I should have looked at 
[02:46:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9962) the clock more um I could go on for a little bit longer if you want to because there are things I think is important to cover 
[02:46:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9971) okay I'm just going to continue while we are figuring out how to do this right um so text 3D we're going to assemble the diffuse IBL um so then we need the coordinates in 
[02:46:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9984) this one and we're like as we did before we're going to use the direction to rectal linear and so here we go uh directions right linear 
[02:46:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=9996) and then the direction in this case is going to be the normal Direction so I dot um normal right is that what we named it yeah 
[02:46:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10005) so instead of using the view Vector which we used for the Skybox we're going to use the normal vector so this is going to give us a color and then 
[02:46:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10015) um yeah then let's just output that so float forward diffuse IBL um or blood three let's just care about those uh diffuse IBL and then we show that color and then we go back and we 
[02:47:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10031) haven't assigned that yet so we need to assign it over there and there we go uh so now we have a very very simple uh lighting or diffuse lighting uh coming off of the 
[02:47:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10044) environment on this object right also we are also getting these issues with a seam that is going around here this is not an issue if you use Cube Maps this is specifically an issue when 
[02:47:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10057) you're using um when you're using a 2d flat texture the way you do here that's why we had to do the text 2D load thing to prevent this 
[02:47:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10065) from happening which is a little annoying um you can blame me for that I didn't find a cube map based texture before uh 
[02:47:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10075) before streaming so um so now we got our uh we got our diffuse lighting but then we also need to apply this to the object because now we're just showing the lighting section 
[02:48:05](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10085) of this but we actually want to apply this to the rest of our object the way we did before right I'm also going to turn down the displacement because it's kind of annoying to look at when I used 
[02:48:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10096) unity's built-in Cube map thing for the Skybox I still got seams on each edge of the cube uh yeah that is also an issue you need to sort of work around when you're using Cube Maps instead of this 
[02:48:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10106) but anyway we got our diffuse light uh let's apply it to the object um oh and also this should not be there this should not be there I presume this 
[02:48:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10117) is because the textures are not set to be wrapped or they're not said to be clamped but they should be they should be clamped on the y-axis so now we want to repeat it along the 
[02:48:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10127) x-axis if I clamp it on the y-axis so we're going to do per axis U repeats and V clamp there we go that's fixed uh all right let's use this as lighting now so now we have the diffuse IBL 
[02:49:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10141) itself but we also need to apply it um so let's cut that out or actually no yeah let's move that out and comment out this code because we're 
[02:49:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10153) going to use it later uh so now we're sampling the diffuse IBL and we want to use this in the lighting functions right so diffuse IBL is going to be part of our lighting contribution 
[02:49:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10166) I'm going to replace that we're going to replace it um this ambient light with our IBL right um so we could take this whole thing move it in here 
[02:49:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10181) so now instead of just adding a color we're going to add the IBL here and this one we should also use the the normal Vector we calculate here based on the normal map so instead of 
[02:49:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10194) using the the vertex normals we're going to pass in the at the normal we have after we've applied the normal map so now we have the diffuse IBL we added to the diffuse light and if we go back and 
[02:50:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10206) we now have an object that is also lit from the environment and the one of the nice things about doing this is that your objects tend to look way more grounded like they're 
[02:50:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10219) actually supposed to be in that environment so now it kind of looks like a very shiny silvery thing in this deserty environment um maybe we can even try to match it to 
[02:50:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10230) the background and make it a little um there we go now it's all coppery so that's uh diffuse image based lighting um and if we rotate this object uh 
[02:50:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10243) obviously the image based lighting is still going to be applied from the correct directions and everything because we're doing this in World space right 
[02:50:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10251) um and all the other objects should also work and so forth is the height map still off yes we can apply that again displacement strength 
[02:51:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10263) if you want to I just put it at zero because it's easier to look at the sphere without all the holes in it um because it looks a little wonky as soon 
[02:51:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10273) as you have too strong of a displacement actually it looks pretty okay now yeah oh that's the that's the seam right there is this kind of how Ray tracing works or am I completely off uh this is 
[02:51:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10285) not Ray tracing at all this is we're taking a direction and we're sampling a color in that direction Ray tracing generally involves a lot of steps where you're like marching through some data 
[02:51:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10297) and then searching for the hit of a ray so this is not retracing no because this is pre-baked data all the reflection data is already in this texture right here so this is the texture we're using 
[02:51:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10311) just a very small 256 by 128 texture and then we're sampling this in a direction which matches our environment is this level two I mean lighting what's level three this is level two yes so level 
[02:52:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10323) three uh would involve specular image based lighting because right now we've only looked at um diffuse ambient lighting right um so we want to add specular 
[02:52:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10335) Reflections to this too so let's go back to this section also we don't need scale offset on these so I'm just going to add that there 
[02:52:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10346) so this is going to be our specular IBL um and then we just add it here the writer why do I have this why do I have a clicky link cursor thanks 
[02:52:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10371) uh okay so we have a specular IBL Let's see we have a direction to rectilinear um right so this is going to be very similar 
[02:53:04](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10384) let's try it out let's make another sample um let's grab the same line here as we had to the diffuse IBL 
[02:53:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10396) specular IBL uh text Hootie LOD specular IB owl and then we have the same code here for the direction directed linear and we need to use the float forward to sample 
[02:53:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10414) from the lowest MIP level right now at least okay um so that that should give us a a bad version of specular IPL um 
[02:53:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10425) let's see uh right the normal doesn't exist here so i.normal now we're not supposed to use the normal here um let's see let's assign it uh 
[02:53:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10437) there we go uh so this one is obviously a little bit more shiny it's it's crisp it's not blurring um but we want this to be a reflection 
[02:54:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10446) right it should look sort of like a chrome ball at this point but we're using the wrong Vector we're just using the normal Vector at this point um so this is not the way it's supposed 
[02:54:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10456) to look uh so what we need to use um is the um view reflection Vector as in if we take the view vector and the reflected 
[02:54:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10467) off of the normal then we should get the vector pointing to this point in the sky that we want to sample this at so uh yes reflect the view through the normal so flow three view reflection 
[02:54:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10482) uh then that's going to be the um we're going to do reflect the negative view Vector do we have the view vector uh 
[02:54:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10496) uh where's the view vector oh V there we go we're just going to move that to the top of this here there we go got the view Vector all right so we're going to take 
[02:55:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10508) the view Vector we're going to negate it because the the reflect function takes an incoming vector and then we want to reflect that around the normal so we're just going to grab 
[02:55:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10519) the vertex normal um why is this angry with me did I break the syntax somewhere I feel like I didn't 
[02:55:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10530) right um okay so then we should use the viewer reflection Vector here let's let's Bank and recompile and there we go so now we have something that is 
[02:55:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10542) actually a reflection right um so now we get this chrome effect that looks way fancier than just using the normal right and we can look at the other objects 
[02:55:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10552) they're also very Chrome right now um and so so this type of this type of effect is sometimes called environment mapping I usually use Cube maps for this but in our case we're using the 
[02:56:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10567) retilinear map um yeah how expensive is all of this can you stick this data on all objects in the scene or more of a certain hero 
[02:56:15](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10575) models or selected pieces this is very cheap um this is a texture sample it's not much more than that um so doing this type of thing is very 
[02:56:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10583) very cheap um the downside of doing this everywhere is that you tend to have things be over lit as in everything is lit as if it's standing out in nowhere even though 
[02:56:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10595) there are walls around it that should include this so usually there's a lot of occlusion that you add on top of this as well like sometimes you have occlusion Maps baked into this sometimes you have 
[02:56:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10605) like screen space ambient occlusion like there are a lot of things you can add on top of this to make it look a little bit more realistic it looks really good in isolation but once you put it in the 
[02:56:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10614) context of a game it's kind of it's much harder to make it look good um can you turn real quick how to get this Skybox set up globally instead of sending the textures to everything 
[02:57:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10623) um so um it depends on how you want to do it if you want to do it through Unity systems which you probably should Unity has a system of uh what's called 
[02:57:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10633) reflection probes and reflection probes uh bake this data to cube maps and then depending on where objects are in your scene they're going to use the nearest Cube map so reflection probes is a 
[02:57:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10646) system for basically doing this where Unity takes a screenshot of your scene and bakes it to a cube map and then your shaders are going to be automatically fed that data 
[02:57:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10657) like setting that up can be a little complicated again you need to dig into Unity shaders and their lighting system or if you use the standard Shader then that's going to happen automatically so 
[02:57:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10667) it kind of depends on on how you want to set that up if you want to um if you want to like pass this as a global variable into something um all you need to do to set a global 
[02:57:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10679) variable um is to delete the property here but you keep the um but you keep the sampler here and then you use shader.set Global 
[02:58:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10694) texture and that's it and then it's it's going to properly read from that texture yeah there you go I don't know if I answered the question because it was sort of a two-part if you like but 
[02:58:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10704) um anyway okay so we got the uh we've got the ear reflection specular IBL we've now sampled that um 
[02:58:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10714) now one thing that we should also do is that remember how we have a glossiness slider right now everything is fully glossy this is maximum glossiness um and it's not rough whatsoever so we 
[02:58:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10728) probably want this one to also adapt to the glossiness of the surface right so in that case we can use the MIP maps in order to sample a different mid level and because MIP Maps they are kind of 
[02:59:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10741) downsampled blurry versions of this so if you do that then it's going to look as if we're changing roughness of the surface so usually when you have this type of image based lighting for 
[02:59:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10752) specular Reflections the blurrier versions of these are usually in the MIP levels so if we want to pipe in our glossiness value we can take our gloss 
[02:59:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10767) um and then we can pick a MIP level from that so let's just do float MIP equals glass um now MIP levels are gonna go from zero which is the highest detail and then 
[02:59:39](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10779) um as you go higher so you go from zero to one to two to three every integer is going to be the next MIP level down um so we'd probably want to invert this because the higher the value the more 
[02:59:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10792) rough the surface is and then multiply it by the number of myth steps that we have um I don't really know how many mid steps we have there might be ways of 
[03:00:02](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10802) actually getting that information there might be I'm not sure but we're just going to presume that it's going to be about seven mid panels there we go that's that's my professional 
[03:00:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10811) professional way of just hard coding that um and then we'll pass in the MIP level into the texture sampler um and then let's see if it works 
[03:00:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10821) so now we can change our gloss value and it's going to change how rough this surface looks right uh generally looks like super low risk and wonky when you're up close and 
[03:00:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10834) especially when you don't have anything else applied to it maybe we went like one step too far I feel like this one looks okay but this one is a little too low-risk uh so let's let's go for six 
[03:00:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10844) instead of seven there we go it's also worth noting that sometimes the way that you calculate these MIP Maps is heavily going to affect the quality of these Reflections 
[03:00:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10856) because they usually want to have convolved lighting rather than just um rather than just like blurring it and like sampling it into a lower resolution anyway so now we have sort of a way of 
[03:01:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10870) setting the glossiness value using this image based lighting right so now we need to actually apply this to our Shader uh oh I was considering talking about 
[03:01:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10885) we're overtime now so I don't know how detailed I should go there are things I want to say but I don't know if I should say that anyway I should probably skip that I'm sorry 
[03:01:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10895) um okay so so now we have the specular IBL uh now I should just use this because we're not using it yet um so 
[03:01:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10905) uh okay cut that out don't need this anymore and let's go to our lighting section um and again specular IBL we just want to 
[03:01:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10917) add that once we don't want to add that for every additional light source that we have so let's see uh yep so that would be here 
[03:02:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10929) could you share a Unity package with the textures and stuff yes I will do that um I will send you all of this like this entire project I will send it to you 
[03:02:18](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10938) um so if it's in base pass and if uh all right so that's pretty much the same thing we did before um set up the view reflection Vector 
[03:02:30](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10950) outside of the MIP level sample the specular IBL um and uh yeah so now we have um diffuse IBL up here and we add that 
[03:02:41](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10961) to the diffuse line and then we add just the way we added it to the diffuse light we add the specular to the specular light so specular light plus equals specular 
[03:02:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10977) um IBL there we go so for now go back um this is now a very shiny object but it's not using the correct normals so 
[03:03:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=10989) now it kind of looks like a marble textured thing with excessive light um so we need to um not use this normal here we need to use the normal after the normal map 
[03:03:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11003) right there we go recompile and now I believe we have a very very very intense uh reflection 
[03:03:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11014) on this um okay so it might be worth it to have some way of controlling how intense this should be 
[03:03:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11023) uh so let's go to our parameters um spec IBL intensity 
[03:04:03](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11043) uh all right then that should be a range and then we just multiply that by the intensity of that sometimes that's called occlusion like specular occlusion um if you want to have some way of 
[03:04:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11061) reducing the amount of uh indirect specular or indirect um diffuse light um just had to add it to the 
[03:04:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11073) all the parameters uh all right there we go um so now we can change the intensity of the the specular light of this too but you get the idea looks very shiny and 
[03:04:46](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11086) neat I wonder if we can just straight up uh remove the anyway yeah you could do the same for the um the intensity of the diffuse IBL as 
[03:04:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11099) well in case you want to reduce how strong that is and so forth because now this one is like very aggressive it's super super strong right um oh so one more thing that I'm going 
[03:05:09](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11109) to cover that I wanted to cover that I sort of I'm not going to skip it um uh let's see uh let's first remove the normals 
[03:05:27](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11127) perfect okay so we got our specular Reflections here um just gonna increase the intensity a little bit so depending on the surface 
[03:05:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11135) that you have uh if you have a chrome object then generally uh you're gonna have a very very clear reflection in all directions uh but for many other objects that are just like very polished uh then 
[03:05:48](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11148) the uh the reflection is going to be stronger around the edges of the objects um more specifically where the angle is very low toward the surface and now we're back to for now 
[03:06:00](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11160) so quite often when you're setting up these types of Reflections they generally look much better if you fade the reflections out toward the center so that you don't have a full Reflections 
[03:06:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11171) like face on it's useful if you want to make Chrome but most things don't reflect that way um so so this is a case where fresnel is going to be really really useful so 
[03:06:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11183) I'm just going to set up a simple fresnel float friend now and we're going to take the dot product between the view vector God damn it autocomplete 
[03:06:36](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11196) uh dark Rider between the view vector and the normal uh we're gonna saturate that to make sure we don't get any funky values um and 
[03:06:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11207) um and then we want to um they don't want to usually you want to raise it to the power of something so and you also want to usually invert it 
[03:06:59](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11219) so if we just apply this now we multiply it into the specular light you can see that we now have falloff the reflection is not as strong in the center 
[03:07:11](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11231) um but usually you want to want that to only happen at the very edges um so we're going to raise this to the power of five which I think is a pretty 
[03:07:22](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11242) good approximation for the physical effects um and there we go so now you can see that the reflections are pretty strong at the 
[03:07:32](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11252) edges you can probably see that they're sort of wandering around there but you don't have this like a really weird mirror reflection everywhere right you can especially see the little sunlight 
[03:07:42](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11262) there um yeah um all right I can probably bump up the intensity now since it's not as uh all 
[03:07:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11272) over the place um so there you go then you usually get those little Halo effects uh around the whole thing which is pretty close to what you get in reality 
[03:08:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11281) um I wanted to see if we can show this in reality but it was kind of difficult to see on stream but if you have colored things as well like a Coke can or other like colored Metals uh then quite often 
[03:08:13](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11293) the reflections that you're going to get are going to be red in the center they're going to be tinted by the color in the center and as you go toward the edges the tinting is going to drop and 
[03:08:26](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11306) it's going to be it's not going to be as colored by that red color it's sort of a similar effect where on the very edges you might see it on this side um then it starts going more yellow and 
[03:08:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11317) sharper and hey camera nope don't stop uh but yeah anyway it's much much easier to see it uh in reality so if you have like a Coke can or something that is colored metal you tend to see this 
[03:08:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11331) effect pretty strongly okay um I feel like there's a whole huge category of things that we haven't talked about that I feel like we should talk about 
[03:09:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11341) um so I don't know I don't know what to do about that but I think we covered quite a lot there are lots of stuff when it comes to like optimization like GPU instancing and draw calls and batching 
[03:09:14](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11354) um but I mean you can still um you can still read up on that I don't think you need me to explain that it's relatively easy to Google for yeah I think that's I think we covered most of 
[03:09:23](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11363) the important stuff does this all work if you add walls or other objects uh yeah kinda but it's not going to be occluded by the walls so these are just sampling the sky like straight up they 
[03:09:34](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11374) don't care about other geometry at all they also realize I actually never enabled all the stuff in this again um because we had our displacement and 
[03:09:45](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11385) um we want to use the wait I feel like something is very wrong why is it looking so smooth I feel like the specular is not using the normal map 
[03:09:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11395) oh normally intensity is probably no I remove the normal map that's why there we go hell yeah this is an incredibly Shiny Rock um 
[03:10:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11410) so there we go okay a tin foil ball very much so yeah uh it's a little too intense probably so shiny definitely emits more light than it receives yes thank you all so 
[03:10:25](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11425) much for joining I hope this was useful uh I'm sorry I didn't catch everything I would would have wanted to catch this is a very broad topic and it's really hard to cover everything that you might find 
[03:10:37](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11437) useful in the future I think that the biggest thing that I really wanted to cover was a render textures okay so if you if you want me to show stuff from flowstorm I can do that let's do that 
[03:10:47](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11447) because that would actually um sort of cover render textures to some extent not exactly how to use them but what you can use them for it's render text or shaders though isn't that just 
[03:10:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11456) more built in unity and you can just apply them to objects they're very closely related to what you can use shaders for and why they might be useful um so the example that I was going to 
[03:11:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11466) make was let's say you have snow in an environment and you want to have a character where if they walk in the snow you want that to like push the snow down so that you can create like tracks in 
[03:11:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11479) the snow simple example um so so basically what you would use to render texture for is that the render texture would contain a height map for how high the snow should be and that 
[03:11:31](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11491) every time every time the player moves you would render something into that render texture using shaders and then in a a separate Shader for the snow itself you would read from that height map that 
[03:11:43](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11503) would then push it down in the vertex Shader so that was just one example of how you can use render textures you know what this game might be broken I forget what state I left it in okay 
[03:11:55](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11515) seems to work cool I guess there are a lot of like things I could go into but I use sort of a custom lighting system in flow serum I don't use unity's lighting system at all 
[03:12:07](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11527) um so for instance the light you see coming off of the rocket here is using that lighting system the same thing with the light coming out from the checkpoints and the specular light on 
[03:12:17](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11537) the rocket when you get close to them and so forth so that's a whole system that I've set up it contains many many different render textures so for instance if I enable those textures you 
[03:12:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11548) can now see the data that I use in my lighting system so in the top left it basically renders light sources into a render texture that is just mapped to the screen and then in all of the 
[03:12:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11564) objects I read from that texture in order to color this objects with light It's relatively simple the other three buffers are for specular highlights they are not very optimized right now I'm 
[03:12:56](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11576) pretty sure I can cut them down like substantially but basically they contain a vector pointing to the nearest light source and then every buffer along this points to the second nearest light 
[03:13:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11588) source this points to the third nearest light source and then it reads from this texture in order to like Point like do specular Reflections because we need the direction to the light source right so 
[03:13:19](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11599) all of this lighting is done in screen space um rather than being done in World space and we don't render the meshes with additional passes it's all done in a 
[03:13:29](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11609) single pass when rendering the objects themselves so you can read from all of these textures and then that way it can like apply lighting to the objects and and all of these are generated in real 
[03:13:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11620) time so none of these are baked or anything so these are all happening all the time then other things I have um so I guess that oh yeah these headlights 
[03:13:51](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11631) are a little bit more visible when in the buffer in the top left um other things I use textures for is the water for instance here has a little 
[03:14:01](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11641) wave effect although it's not frame rate independent yet so it doesn't look super good uh with high frame rate um but the water waves can wobble when you hit the water or leave the water I 
[03:14:12](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11652) don't know if it's going to be super visible it's kind of hard to hard to show um let's see if I can 
[03:14:24](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11664) there we go so the rocket coming out of the water like this I will deform the water mesh so you can see that it's a tessellated mesh it has a border mesh along the edge here 
[03:14:35](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11675) um so it's separated into multiple meshes yeah these are combined into a single mesh so I can't like separate them but there's one mesh on the top there's one 
[03:14:44](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11684) mesh along the border to create this little gradient and then there's another mesh in the bottom that creates this um that just had a bit has a bit of an overlay on top of everything 
[03:14:54](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11694) um yeah and then so so there's a wave it's created by writing values into a depth buffer or into a render texture and then the waves themselves are animated in the 
[03:15:08](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11708) um in texture space and then um so we get these waves but it doesn't actually modify the vertices of the mesh the mesh is just reading from a texture and then we get these waves from it 
[03:15:20](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11720) um I don't know if we can just quickly enable vsync to make the waves more visible because now they're like rapidly animating um 
[03:15:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11728) but um uh yeah I thought I had a way of visualizing those I wonder if I just commented it out okay 
[03:15:40](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11740) um [Music] deepakview.water data oh right I had a debug View I forgot about that 
[03:15:57](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11757) um there we go in the top left you can see the render textures that I'm using for the water so these are textures and they are 
[03:16:10](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11770) shaders are writing and reading to these textures all the time so that they are animating the waves and applying different values so that we get this effect right I forgot what the lower one 
[03:16:21](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11781) is one of them is the height I think the lower one is the normal direction of of the water so that also needs to be calculated and the top one is the height of the water I have a bunch of 
[03:16:33](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11793) parameters for the water this one made the water go very sad my water is now spazzing out oh geez in your own I just made it made it very strong you 
[03:16:52](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11812) know I broke my water it animates too quickly now oh geez oh no my water it's broken this coat is not great rip anyway quick question about stencil what can you 
[03:17:06](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11826) normally use them for other than cutting a hole in a mesh only encounter them briefly um well stencil buffer is basically a screen space mask and you have about 
[03:17:16](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11836) like is it eight bits I forget how many bits you have where you can either make something render if it's inside of the Mask or not rendered if it's inside of the mask and that type of stuff 
[03:17:28](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11848) um so it kind of depends on what like you can do that type of stuff but generally it involves um showing something somewhere or not 
[03:17:38](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11858) showing something somewhere if you want to do stuff like yeah it's just a really really useful and quick way to get like a screen space mask essentially but it's only one bit so you can't like do any 
[03:17:49](https://youtu.be/E4PHFnvMzFc?si=xnkdXYk1v-M34tlj&t=11869) fancy fading or anything okay I think that's gonna be it uh I think I'm done for today uh hope this was useful thank you for tuning uh I will see you next time 